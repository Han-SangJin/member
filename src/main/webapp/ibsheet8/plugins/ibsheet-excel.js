/**
 * 제 품: IBSheet8 - Excel Plugin
 * 버 전: v0.0.5-DEV.4 (20201117-2203)
 * 회 사: (주)아이비리더스
 * 주 소: https://www.ibsheet.com
 * 전 화: (02) 2621-2288~9
 */
l022[531428]=window;l022[246316]=true;l022[579393]=false;l022[531428].m3pp=l022;l022[556961]="Or5";l022[36664]="Gxy";function l022(){}l022[360432]=276;l022[27315]=715;l022[532940]=true;l022[241507]="_Ou";!(function(Q,V){var E8C="getSheetFontSize";var c5l="Mode";var e5l="Color";var T8l="{";var o5l="OrgCol";var g8C="GetDataRowHeight";var B0C="IBSheetLoadExcelFileFinder";var A6l="width:0px;";var Z4C="getSumBackColor";var i5C="SetDown2TextConfig";var a7l="downloadTokenValue";var D8l="-";var z2l="Bool";var Q8C="GetRHeight";var u4C="ColLength";var B5l="DirectLoadExcel.jsp";var k4l="#808080";var R9l="hidden";var S9l="multipart/form-data";var A3l="HmsFormat";var I1l="Type";var G5l="Alert";var d5C="getLoadTextConfig";var t5l="UnMatchColHidden";var K9l="none";var g7l="=";var C4l="#";var g9l="Down2Pdf";var S5l="StartCol";var u8C="down2Text";var b4C="doSearchScript";var C9l="forEach";var d4l="#000000";var z8C="GetDown2PdfUrl";var K4C="Encoding";var N5C="loadExcelError";var G4C="DoSearchScript";var x7l="ColAlign";var J4l=/\s+$/;var U8C="GetSheetFontSize";var L9l="includes";var H5C="GetDown2TextConfig";var A0l=1;var f9l="post";var v4l="#808000";var j5C="getDown2ExcelConfig";var T9l="&";var l8C="GetStatusValue";var y6l="fontTo";var e1l="Panel";var h4l="#800000";var U5C="GetLoadExcelConfig";var O2l="Filter";var W9l="</";var h9l="iframe";var H5l="EndRow";var j5l="SearchMode";var d6l="debugMode";var O0C="IBSheetLoadExcelFrame";var i9l="input";var g5C="SetLoadExcelConfig";var v6l="html";var B4l="#008080";var H8C="getColName";var S5C="getDown2TextConfig";var e4C="GetNextColA";var q4l="#000080";var K4l="#ff00ff";var O3l="YmdHmFormat";var U9l="Down2Text";var D8C="loadText";var d8C="Down2ExcelBuffer";var w9l="Link";var i5l="WorkSheetNo";var W8C="getDown2PdfUrl";var X2l="LegacyFormat";var a4C="InvalidExcelFileExtension";var f5l="UserSaveName";var M8l="1";var x3l="YmdHmsFormat";var L7l="SubSumRow";var b4l=",";var P0l=2;var p6l=" !important }</style>";var q6l="gi";var y5l="Append";var r8C="LoadExcelBuffer";var a5l="HeaderRows";var x6l="<br>";var L5l="RowSpan";var R5C="setDown2TextConfig";var A8C="getDown2ExcelUrl";var I2l="H";var I4C="getNextColA";var w8C="getStatusValue";var m3l="YmdFormat";var j8l="boolean";var J6l="body";var L8C="GetLoadTextUrl";var a8l="\n";var P5l="LoadExcelUrl";var d5l="StatusCol";var p2l="Date";var p4l="[object Array]";var G8l="TEXT";var x4l="#ffff00";var I8C="setDown2TextUrl";var o9l="toLower";var D7l="WordWrap";var N5l="StartRow";var m2l="TitleText";var C8C="GetDown2TextUrl";var A5l="LoadExcel.jsp";var X7l="ColWidths";var r8l=/^[^\<\{]*\{/;var N3l="Combo";var s8C="GetExcelRowHeight";var I4l="object";var M0C="IBSheetLoadTextFileFinder";var u4l="#008000";var E5l="MaxCols";var R6l="extendParam";var M8C="getLoadExcelUrl";var i8C="getColIndexInfo";var r9l="0px";var l5C="GetDown2HmlUrl";var o4C="GetSumBackColor";var D5l="IBSheetID";var I6l='lang="ko"';var J8C="GetLoadExcelUrl";var h5l="HeaderText";var w5C="getDown2HmlUrl";var p9l="isString";var o4l="//";var U5l="ExtendParam";var k5l="SaveNames";var B2l="SEQ";var c9l="get";var t9l="DirectDown2Excel";var C8l="Sheet";var l5l="||";var K3l="YmFormat";var p0l=10;var M0l=5;var k9l="SheetWork=";var R5l="WorkSheetName";var q4C="CutText";var M2l="HML";var q5l="ServerFile";var n8l="|";var W8l="\r\n";var V5C="setDown2HmlUrl";var A7l="RecordFormats";var S4l="";var L4C="GetHeaderBackColor";var N4C="InvalidTextFileExtension";var F0l=100;var Y4C="getHeaderBackColor";var B6l="display:none;";var Y5l="Span";var E9l="PDF";var G8C="SetLoadExcelUrl";var g5l="DataFormat";var J7l="RowHeights";var X5l="SheetID";var q8C="down2Pdf";var b6l="Baekmuk Gulim";var m6l='="';var v0C="DirectLoadExcel";var E5C="getLoadExcelConfig";var S3l="EnumKeys";var L4l="div";var N6l="Url";var s3l="LegacyType";var k7l="FileName";var W2l="Enum";var p8l="center";var f3l="center|";var u6l=";";var s5l="fileDownloadToken";var m4l="#800080";var C6l='<style type="text/css">* { font-family: ';var p5l="Background";var B7l="RecordTypes";var r5l="SaveName";var Z5l="C";var T8C="down2ExcelBuffer";var s5C="SetDown2HmlUrl";var O5l="SkipEmptyRow";var p8C="getDown2TextUrl";var D4l="#00ff00";var y5C="setDown2ExcelConfig";var H9l="POST";var Y1l="Float";var b8C="setLoadExcelUrl";var e8l="EXCEL";var v4C="EmptyChar";var O4l="#0000ff";var c4l="#ffffff";var k8l='"';var f8C="down2Excel";var C7l="DownHeader";var V8l="function";var m5l="RecordType";var n4C="getOrgType";var M5l="LoadExcelError";var c1l="ANY";var u5l="DatePattern";var Y9l="keys";var a8C="getDataRowHeight";var X8C="setDown2ExcelUrl";var e6l="head";var L0l=16;var R8C="GetAutoSumPosition";var v8C="LoadFile";var e8C="SetDown2TextUrl";var b9l="has";var j8C="getSheetFontName";var P8C="SetDown2ExcelUrl";var a6l="url";var Q5l="HeaderMatch";var S8C="GetColIndexInfo";var z9l=">";var z4C="GetTheme";var T5l="ColumnMapping";var e4l="^";var X4l=/^\s+/;var j9l="Down2Excel";var m8l="return ";var M4l="0";var D3l="MdFormat";var N1l="undefined";var x5l="UseJsonAttribute";var x8C="loadFile";var F4C="GetOrgType";var c3l="1|";var W1l="Header";var T6l="DebugMode";var r4l="#ff0000";var B0l=0;var f0C="OrgTextHidden";var T5C="SetLoadTextConfig";var e2l="DateFormat";var d8l="}";var V4C="Down2Hml";var A4l="#00ffff";var D4C="ColLength2Byte";var P7l="RecordOrgFormats";var P3l="HmFormat";var T4l="#c0c0c0";var X0l=3;var h6l="className";var C5l="FormulaRow";var s9l="Html";var C4C="GetFirstColA";var D6l="<br/>";var W0C="U";var m8C="loadExcelBuffer";var b5l="Data";var N9l="form";var R4l="onmessage";var c8C="getAutoSumPosition";var f4l="#fffffe";var N7l="/";var g4l="0.0.5-20201117-2203-DEV-4";var z5l="Status";var W4C="getTheme";var j4C="";var d9l="?";var o8C="SetLoadTextUrl";var j4l=null;var f6l="dir";var C0l=8;var J2l="Format";var J0l=4;var F9l="ibsheet";var K2l="TitleAlign";var b2l="Pass";var A0C="LoadText";var c5C="GetLoadTextConfig";var k6l="attrs";var v5l="Merge";var m4C="Deli";var O8C="down2Hml";var E4l="ibexcel";var a5C="setLoadExcelConfig";var Q9l="Text";var k8C="directDown2Excel";var T7l="BaseDir";var B8C="GetDown2ExcelUrl";var V8C="getExcelRowHeight";var O6l="&#160;";var X6l="ExpandLeft";var J0C="IBSheetLoadTextFrame";var x0C="LoadExcel";var v8l=".";var J5l="UseDOM";var e9l="isArray";var Z8C="setLoadTextUrl";var t5C="GetDown2ExcelConfig";var y8C="getRHeight";var Q8l="string";var W5l="DelCheck";var k5C="setLoadTextConfig";var K5l="RecordFormat";var G6l="Malgun Gothic";var x4C="FillRight";var F8C="SetDown2PdfUrl";var I9l="map";var U4l="[ibsheet-excel] undefined global object: IBSheet";var r6l="class";var J8l="ExportFile";var R0C="_ConstWidth";var i4l="message";var t8C="GetSheetFontName";var V5l="float";var r4C="\t";var K8C="loadExcel";var X8l="*";var P6l="CollapseLeft";var Z2l="HH:mm:ss";var N8C="GetColName";var h8C="directLoadExcel";var Q5C="SetDown2ExcelConfig";var c4C="csv";var Y8C="getLoadTextUrl";var a4l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var y8l="number";var w3l="Int";var n8C="setDown2PdfUrl";var A9l="set";var p4C="getFirstColA";var Z9l="<";var F8l=" ";var U7l="_GroupTree";var G9l="pdf";var Y7l="CumulateRow";var w=Q.IBSheet;if(j4l == w)throw new Error(U4l);var u,E,N,d,K,s=w.Plugins;(s.PluginVers || (s.PluginVers={}),s.PluginVers.ibexcel={name:E4l,version:g4l},E=a4l,(u=Q).btoa=u.btoa || (function(L){var H4l="InvalidCharacterError";var z0l=64;var Z0l=63;var N4l=/[^\x00-\xFF]/;var I0l=15;var G0l=6;L=String(L);var F,n,l0,w0,s0,Z,o,Y=B0l,W=[];if(N4l.test(L))throw new Error(H4l);for(;Y < L.length;)(w0=(F=L.charCodeAt(Y++)) >> P0l,s0=(X0l & F) << J0l | (n=L.charCodeAt(Y++)) >> J0l,Z=(I0l & n) << P0l | (l0=L.charCodeAt(Y++)) >> G0l,o=Z0l & l0,Y === L.length + P0l?o=Z=z0l:Y === L.length + A0l && (o=z0l),W.push(E.charAt(w0),E.charAt(s0),E.charAt(Z),E.charAt(o)));return W.join(S4l);}),Q.addEventListener?Q.addEventListener(i4l,q,!A0l):Q.attachEvent && Q.attachEvent(R4l,q),s.GetFnLib=function(V0){return w.__[V0] || void B0l;},w.g_isDown2ExcelBuffer=!A0l,w.g_down2ExcelBuffer=S4l,w.g_isDirectDown2Excel=!A0l,w.g_isLoadExcelBuffer=!A0l,w.g_isDirectLoadExcel=!A0l,w.g_targetExcelSheetID=S4l,w.g_LoadExcelSheetID=[],w.g_LoadExcelBuffer=[],w.g_LoadExcelBufferExt=S4l,w.g_targetTextSheetID=S4l,w.g_Multipart=!B0l,w._ibsUtil=(N={},d={transparent:c4l,black:d4l,silver:T4l,gray:k4l,white:f4l,maroon:h4l,red:r4l,purple:m4l,fuchsia:K4l,green:u4l,lime:D4l,olive:v4l,yellow:x4l,navy:q4l,blue:O4l,teal:B4l,aqua:A4l},{init:function(){var P4l="init";return ((this.elem.parent=this).delProperty(this,P4l),this);},trim:function(Q0){return Q0=(Q0+=S4l).replace(X4l,S4l).replace(J4l,S4l);},delProperty:function(y0,t0){try{delete y0[t0];}catch(j0){y0[t0]=void B0l;}},isEmpty:function(E0){var U0=B0l;return (E0 || B0l === E0 || (U0=A0l),U0);},isZero:function(a0){var g0=B0l;return (B0l !== a0 && M4l !== a0 || (g0=A0l),g0);},isNumberValue:function(N0){var H0=B0l;return (N0=this.trim(N0),this.isEmpty(N0)?H0=B0l:N0 - B0l + S4l != N0 + S4l && isNaN(N0 - B0l) || (H0=A0l),H0);},getCacheGroup:function(S0){return (void B0l === N[S0] && (N[S0]={}),N[S0]);},getCache:function(R0,c0){var i0=S4l;return (this.isEmpty(R0) || this.isEmpty(c0) || (i0=this.getCacheGroup(R0)[c0]),i0);},setCache:function(d0,T0,k0){this.isEmpty(d0) || this.isEmpty(T0) || this.isEmpty(k0) || (this.getCacheGroup(d0)[T0]=k0);},padLeft:function(h0,u0,r0){var K0,m0=B0l,f0=S4l;if((K0=(f0=h0=this.isEmpty(h0)?S4l:h0 + S4l).length,this.isEmpty(r0)))return h0;for((r0=(r0 + S4l).substring(B0l,A0l),m0=K0);m0 < u0;m0++)f0=r0 + f0;return f0;},padRight:function(D0,B0,v0){var O0,x0=B0l,q0=S4l;if((O0=(q0=D0=this.isEmpty(D0)?S4l:D0 + S4l).length,this.isEmpty(v0)))return D0;for((v0=(v0 + S4l).substring(B0l,A0l),x0=O0);x0 < B0;x0++)q0+=v0;return q0;},getWebColor:function(G0,p0){var b0l=7;var G4l="WebColors";var C0,P0=-A0l,A0=G0,X0=B0l,J0=B0l,M0=B0l,b0=B0l;return p0 && S4l === A0?S4l:void B0l !== (C0=this.getCache(G4l,G0))?C0:(A0=(A0 + S4l).toLowerCase(),d[A0]?P0=d[A0]:(B0l < A0.indexOf(b4l)?X0l <= (A0=(A0=A0.replace(/[^\d\,\-]/g,S4l)).split(b4l)).length && (X0=A0[B0l] - B0l,J0=A0[A0l] - B0l,M0=A0[P0l] - B0l,isNaN(X0) || isNaN(J0) || isNaN(M0)?P0=-A0l:(P0=C4l,P0+=this.padLeft(X0.toString(L0l),P0l,M4l),P0+=this.padLeft(J0.toString(L0l),P0l,M4l),P0+=this.padLeft(M0.toString(L0l),P0l,M4l))):C4l === A0.charAt(B0l)?P0=A0:A0.search(/[^0-9a-f]/gi) < B0l && (P0=C4l + A0),-A0l !== P0 && J0l !== (b0=P0.length) && b0l !== b0 && (P0=-A0l)),this.setCache(G4l,G0,P0),P0);},elem:{setValue:function(e0,I0){void B0l !== e0 && (void B0l !== e0.value?e0.value=I0:void B0l !== e0.textContent?e0.textContent=I0:e0.innerText=I0);},select:function(L0){var s4l=9999;L0 && (w.BIPAD && !w.BAndroid?L0.setSelectionRange(B0l,s4l):L0.select());}},isArray:function(Y0){return Array.isArray?Array.isArray(Y0):p4l === Object.prototype.toString.call(Y0);},distinctArray:function(Z0){var n0,o0=B0l,z0=S4l,W0={},F0=[];if(!this.isArray(Z0))return Z0;for((o0=B0l,n0=Z0.length);o0 < n0;o0++)W0[z0=this.isArray(Z0[o0])?Z0[o0].join(e4l):Z0[o0]] || (W0[z0]=A0l,F0.push(Z0[o0]));return F0;},cloneArray:function(w4){var s4=this.isArray(w4)?[]:{};for(var l4 in w4)w4[l4] && I4l == typeof w4[l4]?s4[l4]=this.cloneArray(w4[l4]):s4[l4]=w4[l4];return s4;},getFullPath:function(Q4){var Y4l="<a></a>";var V4=V.createElement(L4l);return (V4.innerHTML=Y4l,V4.firstChild.href=Q4,V4.innerHTML=V4.innerHTML,V4.firstChild.href);},getDomain:function(){var y4=V.location,t4=S4l;return (t4+=y4.protocol + o4l,t4+=y4.host);},escapeRegExp:function(U4){var Z4l="\\$&";var j4=S4l;return (this.isEmpty(U4) || (j4=(U4 + S4l).replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,Z4l)),j4);},jsonStringify:function(H4){var w8l='\\"';var W4l="\\t";var z4l="\\b";var F4l="\\n";var s8l="\\\\";var l8l="\\r";var n4l="\\f";var E4,S4,g4,a4=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,N4={"\b":z4l,"\t":W4l,"\n":F4l,"\f":n4l,"\r":l8l,'"':w8l,"\\":s8l};return (function i4(r4,K4){var S8l=": ";var i8l=":";var t8l="null";var E8l="[\n";var U8l="[]";var c8l="{\n";var H8l="[";var N8l="]";var R8l="{}";var g8l=",\n";var c4,k4,T4,h4,d4,f4=E4,R4=K4[r4];switch((R4 && I4l == typeof R4 && V8l == typeof R4.toJSON && (R4=R4.toJSON(r4)),V8l == typeof g4 && (R4=g4.call(K4,r4,R4)),typeof R4)){case Q8l:return m4(R4);case y8l:return isFinite(R4)?String(R4):t8l;case j8l:case t8l:return String(R4);case I4l:if(!R4)return t8l;if((E4+=S4,d4=[],p4l === Object.prototype.toString.apply(R4))){for((h4=R4.length,c4=B0l);c4 < h4;c4+=A0l)d4[c4]=i4(c4,R4) || t8l;return (T4=B0l === d4.length?U8l:E4?E8l + E4 + d4.join(g8l + E4) + a8l + f4 + N8l:H8l + d4.join(b4l) + N8l,E4=f4,T4);}if(g4 && I4l == typeof g4)for((h4=g4.length,c4=B0l);c4 < h4;c4+=A0l)Q8l == typeof g4[c4] && (T4=i4(k4=g4[c4],R4)) && d4.push(m4(k4) + (E4?S8l:i8l) + T4);else for(k4 in R4)Object.prototype.hasOwnProperty.call(R4,k4) && (T4=i4(k4,R4)) && d4.push(m4(k4) + (E4?S8l:i8l) + T4);return (T4=B0l === d4.length?R8l:E4?c8l + E4 + d4.join(g8l + E4) + a8l + f4 + d8l:T8l + d4.join(b4l) + d8l,E4=f4,T4);}function m4(u4){return (a4.lastIndex=B0l,a4.test(u4)?k8l + u4.replace(a4,function(v4){var f8l="\\u";var h8l="0000";var D4=N4[v4];return Q8l == typeof D4?D4:f8l + (h8l + v4.charCodeAt(B0l).toString(L0l)).slice(-J0l);}) + k8l:k8l + u4 + k8l);}})(S4l,{"":H4});},toJson:function(q4){var x4=j4l;if(Q8l == typeof q4 && B0l <= q4.search(r8l))try{try{x4=JSON.parse(q4);}catch(O4){x4=(x4=new Function(m8l + q4))();}}catch(B4){x4=j4l;}else x4=I4l == typeof q4?q4:j4l;return x4;},toObject:function(P4){var K8l=/\}[^\}]*$/;var A4=j4l;if(Q8l == typeof P4 && B0l <= P4.search(r8l))try{A4=(A4=new Function(m8l + P4.replace(r8l,T8l).replace(K8l,d8l)))();}catch(X4){A4=j4l;}else A4=I4l == typeof P4?P4:j4l;return A4;},exponentToNumberString:function(C4){var x8l="0.";var q8l=/^\-/;var u8l=/[eE]/;var p4,M4=(C4 + S4l).split(u8l),J4=S4l,G4=S4l,b4=S4l;if(A0l == M4.length)return M4[B0l];if((p4=C4 < B0l?D8l:S4l,G4=M4[B0l].replace(v8l,S4l),(b4=M4[A0l] - B0l + A0l) < B0l)){for(J4=p4 + x8l;b4++;)J4+=M4l;return J4 + G4.replace(q8l,S4l);}for(b4-=G4.length;b4--;)J4+=M4l;return G4 + J4;},getFileName:function(I4,L4){return ((I4 + S4l).indexOf(v8l) < B0l && (I4+=v8l,I4+=L4),I4);},getTableBody:function(Z4){var O8l="table";var B8l="tbody";var o4=[],z4=j4l,Y4=B0l,W4=B0l;if(I4l != typeof Z4)return j4l;if(O8l !== Z4.tagName.toLowerCase())return Z4.firstChild;for((z4=(o4=Z4.getElementsByTagName(B8l))[B0l],Y4=B0l,W4=o4.length);Y4 < W4;Y4++)if(B0l < o4[Y4].childNodes.length){z4=o4[Y4];break;}return z4;},removeHTMLTag:function(F4,n4){if(j4l == F4 || Q8l != typeof F4)return S4l;switch(n4){case A0l:return F4.replace(/<([^>]*)>/gi,S4l);case P0l:return F4.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,S4l);default:return F4.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,S4l);}},convert2ByteChar2:function(s8){var y4l=65290;var t4l=65305;var Q4l=65248;for(var V8=new String(),Q8=s8.length,l8=B0l;l8 < Q8;l8++){var w8=s8.charCodeAt(l8);V8+=y4l <= w8 && w8 <= t4l?String.fromCharCode(w8 - Q4l):s8.charAt(l8);}return V8;},wrapUp:function(t8,y8){return y8 + t8 + y8;},getElementsByClassName:function(g8,j8){var P8l="( |$)";var A8l="(^| )";if((j8=j8 || V).getElementsByClassName)return j8.getElementsByClassName(g8);if(j8.querySelectorAll)return j8.querySelectorAll(v8l + g8);for(var N8=new RegExp(A8l + g8 + P8l),a8=new Array(),U8=j8.body.getElementsByTagName(X8l),H8=U8.length,E8=B0l;E8 < H8;E8++)N8.test(U8[E8].className) && a8.push(U8[E8]);return (U8=j4l,a8);}}).init(),s.DirectDown2Excel=function(S8){var i8;if((i8=this.Down2Excel(S8,!B0l),S8 || S8.debugMode))return i8;},s.DirectLoadExcel=function(R8){return (w.g_isDirectLoadExcel=!B0l,this.LoadExcel(R8));},s.Down2Excel=function(c8,d8){if((w.g_isDown2ExcelBuffer5 || w.g_isDown2ExcelBuffer || this.showMessage(this.getMessage(J8l)),void B0l === c8 && (c8={}),w.g_isDown2ExcelBuffer || c8.debugMode)){var T8=this._delayedDown2Excel(c8,d8);return (c8.debugMode && this.hideMessage(),T8);}setTimeout((function(){this._delayedDown2Excel(c8,d8);}).bind(this),F0l);},s._delayedDown2Excel=function(q8,x8){var Z8l="auto";var I8l=/^\s*((http(s?))\:\/\/)/i;var w5l="Down2Excel.jsp";var z8l="-1";var o8l="&gt";var L8l="Post";var b8l="Excel";var Y8l="&lt";this._prepareExportSetting();var k8,f8,h8,K8,u8,m8=S4l,D8=S4l,v8=this,r8=S4l;if((w.g_isDirectDown2Excel=A0l == x8,void B0l === (k8=w._ibsUtil.cloneArray(q8)) && (k8=[]),void B0l === (f8=this.Down2ExcelConfig) && (f8={}),k8.downHeader=this._getDefault(void B0l !== k8.downHeader?k8.downHeader:k8.DownHeader,this._getDefault(f8.downHeader,!B0l)),k8.downSum=this._getDefault(void B0l !== k8.downSum?k8.downSum:k8.DownSum,this._getDefault(f8.downSum,!B0l)),k8.RequiredMark=this._getDefault((k8.RequiredMark,k8.RequiredMark),this._getDefault(f8.RequiredMark,!B0l)),k8.multipart=this._getDefault(void B0l !== k8.multipart?k8.multipart:k8.Multipart,this._getDefault(f8.multipart,!B0l)),k8.textToGeneral=this._getDefault(void B0l !== k8.textToGeneral?k8.textToGeneral:k8.TextToGeneral,this._getDefault(f8.textToGeneral,!B0l)),k8.wordWrap=this._getDefault(void B0l !== k8.wordWrap?k8.wordWrap:k8.WordWrap,this._getDefault(f8.wordWrap,!B0l)),k8.allTypeToText=this._getDefault(void B0l !== k8.allTypeToText?k8.allTypeToText:k8.AllTypeToText,this._getDefault(f8.allTypeToText,!A0l)),k8.appendPrevSheet=this._getDefault(void B0l !== k8.appendPrevSheet?k8.appendPrevSheet:k8.AppendPrevSheet,this._getDefault(f8.appendPrevSheet,!A0l)),k8.autoSizeColumn=this._getDefault(void B0l !== k8.autoSizeColumn?k8.autoSizeColumn:k8.AutoSizeColumn,this._getDefault(f8.autoSizeColumn,!A0l)),k8.checkBoxOffValue=this._getDefault(void B0l !== k8.checkBoxOffValue?k8.checkBoxOffValue:k8.CheckBoxOffValue,this._getDefault(f8.checkBoxOffValue,M4l)),k8.checkBoxOnValue=this._getDefault(void B0l !== k8.checkBoxOnValue?k8.checkBoxOnValue:k8.CheckBoxOnValue,this._getDefault(f8.checkBoxOnValue,M8l)),k8.comboValidation=this._getDefault(void B0l !== k8.comboValidation?k8.comboValidation:k8.ComboValidation,this._getDefault(f8.comboValidation,!A0l)),k8.debugMode=this._getDefault(void B0l !== k8.debugMode?k8.debugMode:k8.DebugMode,this._getDefault(f8.debugMode,!A0l)),k8.downCols=this._getDefault(void B0l !== k8.downCols?k8.downCols:k8.DownCols,this._getDefault(f8.downCols,S4l)),k8.downCombo=this._getDefault(void B0l !== k8.downCombo?k8.downCombo:k8.DownCombo,this._getDefault(f8.downCombo,G8l)).toUpperCase(),k8.downRows=this._getDefault(void B0l !== k8.downRows?k8.downRows:k8.DownRows,this._getDefault(f8.downRows,S4l)),k8.downTreeHide=this._getDefault(void B0l !== k8.downTreeHide?k8.downTreeHide:k8.DownTreeHide,this._getDefault(f8.downTreeHide,! !this.ExcelTreeMode)),k8.excelFontSize=this._getDefault(void B0l !== k8.excelFontSize?k8.excelFontSize:k8.ExcelFontSize,this._getDefault(f8.excelFontSize,B0l)),k8.excelRowHeight=this._getDefault(void B0l !== k8.excelRowHeight?k8.excelRowHeight:k8.ExcelRowHeight,this._getDefault(f8.excelRowHeight,S4l)),k8.excludeSubSum=this._getDefault(void B0l !== k8.excludeSubSum?k8.excludeSubSum:k8.ExcludeSubSum,this._getDefault(f8.excludeSubSum,B0l)),k8.extendParam=this._getDefault(void B0l !== k8.extendParam?k8.extendParam:k8.ExtendParam,this._getDefault(f8.extendParam,S4l)),k8.extendParamMethod=this._getDefault(void B0l !== k8.extendParamMethod?k8.extendParamMethod:k8.ExtendParamMethod,this._getDefault(f8.extendParamMethod,S4l)),k8.fileName=this._getDefault(void B0l !== k8.fileName?k8.fileName:k8.FileName,this._getDefault(f8.fileName,b8l)),k8.hiddenColumn=this._getDefault(void B0l !== k8.hiddenColumn?k8.hiddenColumn:k8.HiddenColumn,this._getDefault(f8.hiddenColumn,!A0l)),k8.merge=this._getDefault(void B0l !== k8.merge?k8.merge:k8.Merge,this._getDefault(f8.merge,this.MultiRecord && this.MultiRecordShape?A0l:B0l)),k8.mode=this._getDefault(void B0l !== k8.mode?k8.mode:k8.Mode,M4l),k8.numberFormatMode=this._getDefault(void B0l !== k8.numberFormatMode?k8.numberFormatMode:k8.NumberFormatMode,this._getDefault(f8.numberFormatMode,B0l)),k8.numberTypeToText=this._getDefault(void B0l !== k8.numberTypeToText?k8.numberTypeToText:k8.NumberTypeToText,this._getDefault(f8.numberTypeToText,!A0l)),k8.onlyHeaderMerge=this._getDefault(void B0l !== k8.onlyHeaderMerge?k8.onlyHeaderMerge:k8.OnlyHeaderMerge,this._getDefault(f8.onlyHeaderMerge,!A0l)),k8.reportXML=this._getDefault(void B0l !== k8.reportXML?k8.reportXML:k8.ReportXML,this._getDefault(f8.reportXML,S4l)),k8.reportXMLURL=this._getDefault(void B0l !== k8.reportXMLURL?k8.reportXMLURL:k8.ReportXMLURL,this._getDefault(f8.reportXMLURL,S4l)),k8.sheetDesign=this._getDefault(void B0l !== k8.sheetDesign?k8.sheetDesign:k8.SheetDesign,this._getDefault(f8.sheetDesign,A0l)),k8.sheetName=this._getDefault(void B0l !== k8.sheetName?k8.sheetName:k8.SheetName,this._getDefault(f8.sheetName,C8l)),k8.sheetNo=this._getDefault(void B0l !== k8.sheetNo?k8.sheetNo:k8.SheetNo,this._getDefault(f8.sheetNo,B0l)),k8.startCol=this._getDefault(void B0l !== k8.startCol?k8.startCol:k8.StartCol,this._getDefault(f8.startCol,B0l)),k8.startRow=this._getDefault(void B0l !== k8.startRow?k8.startRow:k8.StartRow,this._getDefault(f8.startRow,B0l)),k8.tempFile=this._getDefault(void B0l !== k8.tempFile?k8.tempFile:k8.TempFile,this._getDefault(f8.tempFile,S4l)),k8.titleAlign=this._getDefault(void B0l !== k8.titleAlign?k8.titleAlign:k8.TitleAlign,this._getDefault(f8.titleAlign,p8l)),k8.titleText=this._getDefault(void B0l !== k8.titleText?k8.titleText:k8.TitleText,this._getDefault(f8.titleText,S4l)),k8.treeLevel=this._getDefault(void B0l !== k8.treeLevel?k8.treeLevel:k8.TreeLevel,this._getDefault(f8.treeLevel,!A0l)),k8.url=this._getDefault(void B0l !== k8.url?k8.url:k8.URL,this._getDefault(f8.url,S4l)),k8.userMerge=this._getDefault(void B0l !== k8.userMerge?k8.userMerge:k8.UserMerge,this._getDefault(f8.userMerge,S4l)),k8.workbookPassword=this._getDefault(void B0l !== k8.workbookPassword?k8.workbookPassword:k8.WorkbookPassword,this._getDefault(f8.workbookPassword,S4l)),k8.numberExMode=this._getDefault(void B0l !== k8.numberExMode?k8.numberExMode:k8.NumberExMode,this._getDefault(f8.numberExMode,!A0l)),k8.useFormula=this._getDefault(void B0l !== k8.useFormula?k8.useFormula:k8.UseFormula,this._getDefault(f8.useFormula,!A0l)),k8.excelHeaderRowHeight=this._getDefault(void B0l !== k8.excelHeaderRowHeight?k8.excelHeaderRowHeight:k8.ExcelHeaderRowHeight,this._getDefault(f8.excelHeaderRowHeight,S4l)),k8.imageProcessType=this._getDefault(void B0l !== k8.imageProcessType?k8.imageProcessType:k8.ImageProcessType,this._getDefault(f8.imageProcessType,B0l)),k8.excludeFooterRow=this._getDefault(void B0l !== k8.excludeFooterRow?k8.excludeFooterRow:k8.ExcludeFooterRow,this._getDefault(f8.excludeFooterRow,!A0l)),k8.timeout=this._getDefault(void B0l !== k8.timeout?k8.timeout:k8.Timeout,this._getDefault(f8.timeout,B0l)),void B0l === k8.header && (k8.header=f8.header),void B0l === k8.footer && (k8.footer=f8.footer),this._autoExcelModeCheck(k8,this.AutoExcelMode,e8l,!B0l,x8)))return ((k8.tempFile || k8.TempFile) && (k8.sheetDesign=B0l),k8.sheetName=k8.sheetName.replace(/\//gi,S4l).replace(/\?/gi,S4l).replace(/\\/gi,S4l).replace(/\*/gi,S4l).replace(/\[/gi,S4l).replace(/\]/gi,S4l).replace(/\:/gi,S4l),S4l == k8.sheetName && (k8.sheetName=C8l),k8.reportXML?m8=k8.reportXML:S4l != k8.reportXMLURL && ((k8.reportXMLURL + S4l).toLowerCase().search(I8l) < B0l && (k8.reportXMLURL=w._ibsUtil.getFullPath(k8.reportXMLURL)),Q8l == typeof (D8=AjaxCall({Url:k8.reportXMLURL,Method:L8l})) && (m8=D8)),k8.reportXML=m8.replace(/\</gi,Y8l).replace(/\>/gi,o8l),Z8l == (k8.excelRowHeight + S4l).toLowerCase() && (k8.excelRowHeight=z8l),S4l == k8.excelHeaderRowHeight?k8.excelHeaderRowHeight=k8.excelRowHeight:Z8l == (k8.excelHeaderRowHeight + S4l).toLowerCase() && (k8.excelHeaderRowHeight=z8l),S4l != k8.downRows && k8.downTreeHide && (k8.downTreeHide=B0l),W8l == k8.titleText.substring(k8.titleText.length - P0l) && (k8.titleText+=F8l),k8.downRows=n8l + k8.downRows + n8l,k8.merge=this._getNumberValue(k8.merge,B0l,B0l,B0l,P0l),l5l != (h8=k8.downCols) && (n8l == h8.substring(B0l,A0l) && (h8=h8.substring(A0l)),n8l == h8.substring(h8.length - A0l) && (h8=h8.substring(B0l,h8.length - A0l)),k8.downCols=h8),A0l == w.g_isDirectDown2Excel?(k8.downSum=B0l,k8.onlyHeaderMerge=B0l,k8.treeLevel=B0l):(void B0l === this.Source.Down2Excel.Url?this.Source.Down2Excel.Url=w5l:S4l == this.Source.Down2Excel.Url && (this.Source.Down2Excel.Url=w5l),r8=this.Source.Down2Excel.Url),S4l != k8.url && (r8=k8.url,w.g_isDown2ExcelBuffer && (w.g_DirectDownUrl=r8)),K8=k8.extendParam,u8=k8.extendParamMethod,this.Down2ExcelBufferInfo.extendParam=K8,this.Down2ExcelBufferInfo.extendParamMethod=u8,this._getDown2Excel(k8,function(O8){v8._sendDown(O8,r8,K8,u8,k8.multipart,e8l,k8.debugMode,k8.timeout);}));void B0l === w.g_isDown2ExcelBuffer5 && setTimeout(function(){v8.hideMessage();},p0l);},s.Down2ExcelBuffer=function(B8,J8){this._prepareExportSetting();var P8=S4l,X8=this.IB_DELIMITER_SHEET.length;if(this._autoExcelModeCheck(S4l,this.AutoExcelMode,e8l,!B0l,!A0l,B8)){if(B8)return (w.g_isDown2ExcelBuffer=B8,this.showMessage(this.getMessage(J8l),(this.SuppressMessage || B0l) + A0l,A0l),void (w.g_isDown2ExcelBufferQueue=!B0l));if(!B8 && this.Source.Down2Excel && S4l != w.g_down2ExcelBuffer){(w.g_isDown2ExcelBuffer=B8,this.fileDownloadCheckToken=w.g_isDown2ExcelBufferToken,w.g_isDown2ExcelBufferToken=j4l);var A8=this;return (w.fileDownloadCheckTimer=Q.setInterval(function(){A8._getCookie(s5l) == A8.fileDownloadCheckToken && (A8.fileDownloadCheckToken=j4l,A8._finishDownload());},F0l),P8=w.g_isDirectDown2Excel?w.g_DirectDownUrl:this.Source.Down2Excel.Url,this._sendDown(w.g_down2ExcelBuffer.substring(B0l,w.g_down2ExcelBuffer.length - X8),P8,this.Down2ExcelBufferInfo.extendParam,this.Down2ExcelBufferInfo.extendParamMethod,w.g_Multipart,e8l,J8));}}},s.GetDown2ExcelConfig=function(){return this.Down2ExcelConfig;},s.GetDown2ExcelUrl=function(){var M8=S4l;return (this.Source.Down2Excel.Url && (M8=this.Source.Down2Excel.Url),M8);},s.GetLoadExcelConfig=function(){return this.LoadExcelConfig || ({});},s.GetLoadExcelUrl=function(){var G8=S4l;return (this.Source.LoadExcel.Url && (G8=this.Source.LoadExcel.Url),G8);},s.LoadExcel=function(l5){(this.LoadFileType=e8l,this.LoadExcelExecute=A0l);var Y8=this.MultiRecordShape;(this.MultiRecordShape=B0l,this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var o8,Z8,z8,W8,F8,n8,e8,b8=w._ibsUtil.cloneArray(l5),p8={},C8=S4l,I8=[],L8=S4l;if((w.g_targetExcelSheetID=this.id,w.g_isLoadExcelBuffer || (w.g_LoadExcelSheetID=[]),w.g_LoadExcelSheetID.push(this.id),void B0l === b8 && (b8=[]),void B0l !== this.LoadExcelConfig && (p8=this.LoadExcelConfig),b8.append=this._getDefault(void B0l !== b8.append?b8.append:b8.Append,this._getDefault(p8.append,!A0l)),b8.columnMapping=this._getDefault(void B0l !== b8.columnMapping?b8.columnMapping:b8.ColumnMapping,this._getDefault(p8.columnMapping,S4l)),b8.debugMode=this._getDefault(void B0l !== b8.debugMode?b8.debugMode:b8.DebugMode,this._getDefault(p8.debugMode,!A0l)),b8.endRow=this._getDefault(void B0l !== b8.endRow?b8.endRow:b8.EndRow,this._getDefault(p8.endRow,B0l)),b8.extendParam=this._getDefault(void B0l !== b8.extendParam?b8.extendParam:b8.ExtendParam,this._getDefault(p8.extendParam,S4l)),b8.fileExt=this._getDefault(void B0l !== b8.fileExt?b8.fileExt:b8.FileExt,this._getDefault(p8.fileExt,S4l)),b8.maxFileSize=this._getDefault(void B0l !== b8.maxFileSize?b8.maxFileSize:b8.MaxFileSize,this._getDefault(p8.maxFileSize,B0l,V5l),V5l),b8.merge=this._getDefault(void B0l !== b8.merge?b8.merge:b8.Merge,this._getDefault(p8.merge,A0l)),b8.mode=this._getDefault(void B0l !== b8.mode?b8.mode:b8.Mode,this._getDefault(p8.mode,Q5l)),b8.serverFile=this._getDefault(void B0l !== b8.serverFile?b8.serverFile:b8.ServerFile,this._getDefault(p8.serverFile,S4l)),b8.startCol=this._getDefault(void B0l !== b8.startCol?b8.startCol:b8.StartCol,this._getDefault(p8.startCol,A0l)),b8.startRow=this._getDefault(void B0l !== b8.startRow?b8.startRow:b8.StartRow,this._getDefault(p8.startRow,A0l)),b8.unMatchColHidden=this._getDefault(void B0l !== b8.unMatchColHidden?b8.unMatchColHidden:b8.UnMatchColHidden,this._getDefault(p8.unMatchColHidden,S4l)),b8.useDOM=this._getDefault(void B0l !== b8.useDOM?b8.useDOM:b8.UseDOM,this._getDefault(p8.useDOM,!A0l)),b8.workSheetName=this._getDefault(void B0l !== b8.workSheetName?b8.workSheetName:b8.WorkSheetName,this._getDefault(p8.workSheetName,S4l)),b8.workSheetNo=this._getDefault(void B0l !== b8.workSheetNo?b8.workSheetNo:b8.WorkSheetNo,this._getDefault(p8.workSheetNo,A0l)),b8.skipEmptyRow=this._getDefault(void B0l !== b8.skipEmptyRow?b8.skipEmptyRow:b8.SkipEmptyRow,this._getDefault(p8.skipEmptyRow,!B0l)),this._uploadDialogLoadType=b8.dialogType || b8.DialogType,this._autoExcelModeCheck(b8,this.AutoExcelMode,e8l,!A0l,!A0l))){if((this.GetLoadColNames(I8,b8),n8=this._getHeaderText(I8),o8=(e8=this._getColInfo(b8,I8,!A0l)).name,Z8=e8.saveName,z8=e8.type,W8=e8.format,F8=e8.datePattern,dataFormat=e8.dataFormat,C8+=this._makeColumnTag(y5l,b8.append?A0l:B0l),C8+=this._makeColumnTag(t5l,b8.unMatchColHidden),C8+=this._makeColumnTag(j5l,this.SearchMode),C8+=this._makeColumnTag(U5l,b8.extendParam),C8+=this._makeColumnTag(E5l,I8.length),C8+=this._makeColumnTag(g5l,dataFormat),C8+=this._makeColumnTag(a5l,this.getHeaderRows().length),C8+=this._makeColumnTag(N5l,b8.startRow),C8+=this._makeColumnTag(H5l,b8.endRow),C8+=this._makeColumnTag(S5l,b8.startCol),C8+=this._makeColumnTag(i5l,b8.workSheetNo),C8+=this._makeColumnTag(R5l,b8.workSheetName),C8+=this._makeColumnTag(c5l,b8.mode.replace(/ /g,S4l).toUpperCase()),C8+=this._makeColumnTag(d5l,void B0l !== this.StatusCol?this.StatusCol:S4l),C8+=this._makeColumnTag(T5l,b8.columnMapping),C8+=this._makeColumnTag(k5l,o8),C8+=this._makeColumnTag(f5l,Z8),C8+=this._makeColumnTag(h5l,n8),C8+=this._makeColumnTag(r5l,o8),C8+=this._makeColumnTag(m5l,z8),C8+=this._makeColumnTag(K5l,W8),C8+=this._makeColumnTag(u5l,F8),C8+=this._makeColumnTag(D5l,this.id),C8+=this._makeColumnTag(v5l,b8.merge),C8+=this._makeColumnTag(x5l,this.UseJsonAttribute),C8+=this._makeColumnTag(q5l,b8.serverFile),C8+=this._makeColumnTag(O5l,b8.skipEmptyRow?A0l:B0l),L8=w.g_isDirectLoadExcel?this._getDefault(this.Source.DirectLoadExcel.Url,B5l):this._getDefault(this.Source.LoadExcel.Url,A5l),L8=w._ibsUtil.getFullPath(L8),C8+=this._makeColumnTag(P5l,L8),V8l != typeof Q.postMessage && I4l != typeof Q.postMessage || (C8+=this._makeColumnTag(X5l,this.id)),C8+=this._makeColumnTag(J5l,b8.useDOM?A0l:B0l),w.g_isLoadExcelBuffer))return (w.g_LoadExcelBuffer.push(C8),w.g_LoadExcelBufferExt=b8.fileExt,void (w.g_LoadExcelBufferMaxFileSize=b8.maxFileSize));if(b8.debugMode)return C8;(this._makeLoadForm(e8l,w.g_isDirectLoadExcel,b8.fileExt,C8,b8.maxFileSize,b8.serverFile),Y8 && (this.MultiRecordShape=Y8));}},s.LoadExcelBuffer=function(w5,s5){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());w5=this._getBooleanValue(w5,B0l);if(this._autoExcelModeCheck({},this.AutoExcelMode,e8l,!A0l,!A0l,w5)){if((w.g_isLoadExcelBuffer=w5,s5))return w.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET);!w5 && B0l < w.g_LoadExcelBuffer.length?(this._makeLoadForm(e8l,w.g_isDirectLoadExcel,w.g_LoadExcelBufferExt,w.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),w.g_LoadExcelBufferMaxFileSize),w.g_LoadExcelBuffer=[]):w.g_LoadExcelSheetID=[];}},s.LoadExcelError=function(y5){this._prepareExportSetting();var V5=B0l,t5=w.g_LoadExcelSheetID.length,j5=(this.getMessage(M5l,G5l),B0l),Q5=S4l,U5=j4l;if(!(t5 < A0l))for((void B0l !== y5 && (j5=y5.Code || B0l,(Q5=y5.Msg || S4l) && Q5),V5=B0l);V5 < t5;V5++)((U5=w[w.g_LoadExcelSheetID[V5]]).hideMessage(),w.OnLoadExcelError && w.OnLoadExcelError(U5,e8l,j5,Q5));},s.SetDown2ExcelConfig=function(E5){(this.Down2ExcelConfig=w._ibsUtil.cloneArray(E5),void B0l !== this.Down2ExcelConfig.appendPrevSheet && (M8l === this.Down2ExcelConfig.appendPrevSheet?this.Down2ExcelConfig.appendPrevSheet=!B0l:M4l === this.Down2ExcelConfig.appendPrevSheet && (this.Down2ExcelConfig.appendPrevSheet=!A0l)),void B0l !== this.Down2ExcelConfig.autoSizeColumn && (M8l === this.Down2ExcelConfig.autoSizeColumn?this.Down2ExcelConfig.autoSizeColumn=!B0l:M4l === this.Down2ExcelConfig.autoSizeColumn && (this.Down2ExcelConfig.autoSizeColumn=!A0l)),void B0l !== this.Down2ExcelConfig.comboValidation && (M8l === this.Down2ExcelConfig.comboValidation?this.Down2ExcelConfig.comboValidation=!B0l:M4l === this.Down2ExcelConfig.comboValidation && (this.Down2ExcelConfig.comboValidation=!A0l)),void B0l !== this.Down2ExcelConfig.downHeader && (M8l === this.Down2ExcelConfig.downHeader?this.Down2ExcelConfig.downHeader=!B0l:M4l === this.Down2ExcelConfig.downHeader && (this.Down2ExcelConfig.downHeader=!A0l)),void B0l !== this.Down2ExcelConfig.downSum && (M8l === this.Down2ExcelConfig.downSum?this.Down2ExcelConfig.downSum=!B0l:M4l === this.Down2ExcelConfig.downSum && (this.Down2ExcelConfig.downSum=!A0l)),void B0l !== this.Down2ExcelConfig.hiddenColumn && (M8l === this.Down2ExcelConfig.hiddenColumn?this.Down2ExcelConfig.hiddenColumn=!B0l:M4l === this.Down2ExcelConfig.hiddenColumn && (this.Down2ExcelConfig.hiddenColumn=!A0l)),void B0l !== this.Down2ExcelConfig.RequiredMark && (M8l === this.Down2ExcelConfig.RequiredMark?this.Down2ExcelConfig.RequiredMark=!B0l:M4l === this.Down2ExcelConfig.RequiredMark && (this.Down2ExcelConfig.RequiredMark=!A0l)),void B0l !== this.Down2ExcelConfig.multipart && (M8l === this.Down2ExcelConfig.multipart?this.Down2ExcelConfig.multipart=!B0l:M4l === this.Down2ExcelConfig.multipart && (this.Down2ExcelConfig.multipart=!A0l)),void B0l !== this.Down2ExcelConfig.numberTypeToText && (M8l === this.Down2ExcelConfig.numberTypeToText?this.Down2ExcelConfig.numberTypeToText=!B0l:M4l === this.Down2ExcelConfig.numberTypeToText && (this.Down2ExcelConfig.numberTypeToText=!A0l)),void B0l !== this.Down2ExcelConfig.onlyHeaderMerge && (M8l === this.Down2ExcelConfig.onlyHeaderMerge?this.Down2ExcelConfig.onlyHeaderMerge=!B0l:M4l === this.Down2ExcelConfig.onlyHeaderMerge && (this.Down2ExcelConfig.onlyHeaderMerge=!A0l)),void B0l !== this.Down2ExcelConfig.textToGeneral && (M8l === this.Down2ExcelConfig.textToGeneral?this.Down2ExcelConfig.textToGeneral=!B0l:M4l === this.Down2ExcelConfig.textToGeneral && (this.Down2ExcelConfig.textToGeneral=!A0l)),void B0l !== this.Down2ExcelConfig.treeLevel && (M8l === this.Down2ExcelConfig.treeLevel?this.Down2ExcelConfig.treeLevel=!B0l:M4l === this.Down2ExcelConfig.treeLevel && (this.Down2ExcelConfig.treeLevel=!A0l)),void B0l !== this.Down2ExcelConfig.wordWrap && (M8l === this.Down2ExcelConfig.wordWrap?this.Down2ExcelConfig.wordWrap=!B0l:M4l === this.Down2ExcelConfig.wordWrap && (this.Down2ExcelConfig.wordWrap=!A0l)),void B0l !== this.Down2ExcelConfig.numberExMode && (M8l === this.Down2ExcelConfig.numberExMode?this.Down2ExcelConfig.numberExMode=!B0l:M4l === this.Down2ExcelConfig.numberExMode && (this.Down2ExcelConfig.numberExMode=!A0l)),void B0l !== this.Down2ExcelConfig.useFormula && (M8l === this.Down2ExcelConfig.useFormula?this.Down2ExcelConfig.useFormula=!B0l:M4l === this.Down2ExcelConfig.useFormula && (this.Down2ExcelConfig.useFormula=!A0l)),void B0l !== this.Down2ExcelConfig.excludeFooterRow && (M8l === this.Down2ExcelConfig.excludeFooterRow?this.Down2ExcelConfig.excludeFooterRow=!B0l:M4l === this.Down2ExcelConfig.excludeFooterRow && (this.Down2ExcelConfig.excludeFooterRow=!A0l)));},s.SetDown2ExcelUrl=function(g5){(this.Source.Down2Excel || (this.Source.Down2Excel={}),this.Source.Down2Excel.Url=g5);},s.SetLoadExcelConfig=function(a5){(this.LoadExcelConfig=w._ibsUtil.cloneArray(a5),void B0l !== this.LoadExcelConfig.append && (M8l === this.LoadExcelConfig.append?this.LoadExcelConfig.append=!B0l:M4l === this.LoadExcelConfig.append && (this.LoadExcelConfig.append=!A0l)),void B0l !== this.LoadExcelConfig.useDOM && (M8l === this.LoadExcelConfig.useDOM?this.LoadExcelConfig.useDOM=!B0l:M4l === this.LoadExcelConfig.useDOM && (this.LoadExcelConfig.useDOM=!A0l)));},s.SetLoadExcelUrl=function(N5){(this.Source.LoadExcel || (this.Source.LoadExcel={}),this.Source.LoadExcel.Url=N5);},s._addCellColor=function(k5,S5,i5){var I5l="SubSum";var H5,c5,d5,T5,R5;return k5?(i5 && b5l == S5.Kind && C5l !== S5.id && (this.Cols[i5].Background || this.Cols[i5].Color) && (H5=this.Cols[i5].Background || this.Cols[i5].Color),(S5.Background || S5.Color) && (H5=S5.Background || S5.Color),(S5[i5 + p5l] || S5[i5 + e5l]) && (H5=S5[i5 + p5l] || S5[i5 + e5l]),C5l === S5.id && void B0l === H5 && (H5=this.GetSumBackColor()),b5l == S5.Kind && I5l === S5.Name && (H5=S5.Background || S5.Color),H5 && -A0l !== H5?(-A0l < (H5+=S4l).indexOf(C4l)?X0l == (H5=H5.replace(C4l,S4l)).length && (H5=(c5=H5.substr(B0l,A0l)) + c5 + (d5=H5.substr(A0l,A0l)) + d5 + (T5=H5.substr(P0l,A0l)) + T5):-A0l < H5.indexOf(b4l) && X0l == (R5=H5.split(b4l)).length && (H5=RGB2WebColor(R5[B0l] - B0l,R5[A0l] - B0l,R5[P0l] - B0l)),this._addExcelPaletteList(H5),this.IB_DELIMITER_COLOR + H5):S4l):S4l;},s._addExcelPaletteList=function(f5){(f5=F8l + f5.toLowerCase(),-A0l == this.g_excelPaletteList.indexOf(f5) && (this.g_excelPaletteList+=f5));},s._excelDataFixedMergeRange=function(){var r5,K5=B0l,m5=B0l,u5=B0l,h5=B0l,D5=B0l;for((void B0l === this.FixedMergeTemplate && this._setFixedMergeTemplate(),r5=this.FixedMergeTemplate,m5=B0l);m5 < this.ExcelXB.length;m5++){for((this.ExcelXB[m5],h5=B0l,D5=r5.length);h5 < D5;h5++)K5 == r5[h5][B0l] && (u5=r5[h5][P0l]?m5 + r5[h5][P0l] - A0l:m5,this.ExcelColsMap[r5[h5][A0l]] && this.ExcelColsMap[r5[h5][X0l]] && this._excelSpanRange(this.ExcelXB,m5,this.ExcelColsMap[r5[h5][A0l]],this.ExcelXB[u5],this.ExcelColsMap[r5[h5][X0l]],B0l));++K5 == this.DataRows && (K5=B0l);}},s._excelDataMergeRange=function(){var O5,q5,P5,X5,x5,v5,B5,A5,J5,M5=B0l,G5=B0l;if(!this.MainCol){if(A0l < this.DataRows)for((O5=B0l,M5=this.ExcelXB.length);O5 < M5;O5++)for((x5=this.ExcelXB[O5],q5=B0l,P5=this.ExcelCol.length);q5 < P5;q5++)(((B5=x5)[(A5=v5=this.ExcelCol[q5]) + L5l] || B0l == x5[v5 + L5l]) && A0l != x5[v5 + L5l] || (B5=this._excelMergeTypeExtendBottom(x5,v5,this.XB,O5)),x5 != B5 && this._excelSpanRange(this.ExcelXB,O5,v5,B5,v5,B0l));if(this.DataMergeAction){for((J5=[],q5=B0l,P5=this.ExcelCol.length);q5 < P5;q5++)(v5=this.ExcelCol[q5],this.ExcelColMerge[q5] && J5.push(v5));for(O5=B0l;O5 < this.ExcelXB.length;O5++)for((x5=this.ExcelXB[O5],X5=-A0l,q5=B0l,G5=this.ExcelCol.length);q5 < G5;q5++)(B5=x5,A5=v5=this.ExcelCol[q5],this.ExcelColMerge[q5] && X5++,B0l == x5[v5 + Y5l] || (x5[v5 + L5l] || B0l == x5[v5 + L5l]) && A0l != x5[v5 + L5l] || (B5=this._excelMergeExtendBottom(x5,v5,this.ExcelXB,X5,J5,O5)),(this.DataRowMerge || x5.RowMerge) && B0l !== x5[v5 + L5l] && (B0l == x5[v5 + L5l] || (x5[v5 + Y5l] || B0l == x5[v5 + Y5l]) && A0l != x5[v5 + Y5l] || (A5=this._excelMergeExtendRight(x5,v5,B5,j4l,this.ExcelXB,O5))),x5 == B5 && v5 == A5 || this._excelSpanRange(this.ExcelXB,O5,v5,B5,A5,B0l));}}},s._excelHeaderMergeRange=function(){var p5,e5,Y5,b5,I5,L5,C5;if(this.HeaderMergeAction)for(p5=B0l;p5 < this.ExcelXH.length;p5++)for((b5=this.ExcelXH[p5],e5=B0l,Y5=this.ExcelCol.length);e5 < Y5;e5++)(I5=b5,L5=this.ExcelCol[e5],B0l == b5[(C5=this.ExcelCol[e5]) + Y5l] || (b5[C5 + L5l] || B0l == b5[C5 + L5l]) && A0l != b5[C5 + L5l] || (I5=this._excelMergeExtendBottom(b5,C5,this.ExcelXH,B0l,B0l,p5)),B0l == b5[C5 + L5l] || (b5[C5 + Y5l] || B0l == b5[C5 + Y5l]) && A0l != b5[C5 + Y5l] || (L5=this._excelMergeExtendRight(b5,C5,I5,this.ExcelXH,this.ExcelXH,p5)),b5 == I5 && C5 == L5 || this._excelSpanRange(this.ExcelXH,p5,C5,I5,L5,B0l));},s._excelMergeExtendBottom=function(o5,W5,F5,n5,V7,y7){var l7,w7,t7,Z5,s7=o5,Q7=(o5[W5],P0l),z5=this.DataMergeAction;if((P0l !== z5 && J0l !== z5 || this.PreColumnMergeMode || (Q7=A0l),!this.Cols[o5[W5 + o5l]].ColMerge && (F5 != this.ExcelXH || A0l == this.HeaderMergeMode)))return s7;if(o5.SubSumRow || o5.CumulateRow)return s7;for((t7=(l7=this.GetSheetPageLength()) && P0l == Q7?parseInt(y7 / l7) * l7 + l7:F5.length,w7=y7 + A0l);w7 < t7 && (o5=F5[w7]);w7++)if(C5l !== o5.id){if(o5.SubSumRow || o5.SubSumRow)break;if(A0l < this.DataRows && F5 != this.ExcelXH && !o5.UnitPos)break;if((o5[W5],P0l !== z5 && J0l !== z5 || b5l != o5.Kind))break;if((Z5=j4l,V7?B0l < n5 && (Z5=P0l === z5?V7[n5 - A0l]:V7[B0l]):A0l < (n5=parseInt(W5.substring(A0l))) && (Z5=Z5l + (n5 - A0l)),Z5)){if(!o5[Z5 + L5l] && B0l != o5[Z5 + L5l])break;if(o5[Z5 + L5l] && A0l < o5[Z5 + L5l])break;}}return s7;},s._excelMergeExtendRight=function(U7,j7,T7,m7,H7,r7){var F5l="I";var E7,S7,k7,f7,g7=j7,R7=U7[j7],i7=S4l,a7=U7[j7 + o5l],c7=this.Cols[a7].Section,N7=A0l,h7=this.getType(U7,j7),d7=[z5l,W5l];for(E7=B0l;E7 < d7.length;E7++)if(h7 == d7[E7])return g7;if((!this.DataRowMerge || H7) && !U7.RowMerge)return g7;if(!this.Cols[a7].RowMerge && !H7)return g7;if(F5l == U7.Status)return g7;for((S7=j7.substr(A0l,j7.length),k7=this.ExcelCol.length);S7 <= k7;S7++){if((a7=U7[(j7=Z5l + S7) + o5l],N7=A0l,c7 != this.Cols[a7].Section)){N7=B0l;break;}if(!this.Cols[a7].RowMerge && !H7){N7=B0l;break;}if(U7 != T7)for(E7=r7;;E7++){if(R7 != (i7=(f7=H7[E7])[j7])){N7=B0l;break;}if(f7 == T7)break;}else (i7=U7[j7],B0l != U7[j7 + L5l] && R7 == i7 || (N7=B0l));if(!N7)break;(g7=j7,c7=this.Cols[a7].Section);}return g7;},s._excelMergeTypeExtendBottom=function(K7,x7,A7,B7){var q7,O7,D7=K7,u7=B0l,v7=this.getType(K7,K7[x7 + o5l]);if(!({Status:A0l,Seq:A0l,DelCheck:A0l,Result:A0l})[v7])return D7;for((q7=v7,u7=B7 + A0l,O7=this.ExcelXB.length);u7 < O7 && (K7=this.ExcelXB[u7]).UnitPos;u7++)if(C5l !== K7.id){if(q7 != this.getType(K7,K7[x7 + o5l]))break;D7=K7;}return D7;},s._excelSpanRange=function(X7,M7,e7,z7,o7){var b7,P7,J7,Z7,I7,C7=B0l,Y7=B0l,L7=B0l,G7=parseInt(e7.substring(A0l)),p7=parseInt(o7.substring(A0l));if(void B0l !== X7[M7][e7] && void B0l !== X7[M7][o7]){if(A0l == X7[M7][e7 + L5l] && B0l == X7[M7][e7 + Y5l])for(P7=G7;B0l <= P7;P7--)if(A0l < X7[M7][Z5l + P7 + Y5l]){X7[M7][Z5l + P7 + Y5l]=X7[M7][Z5l + P7 + Y5l] - A0l;break;}for(P7=G7;P7 <= p7;P7++)if(B0l == X7[I7=M7][Z5l + P7 + L5l]){for((C7=B0l,J7=I7 - A0l);B0l <= J7;J7--)if((C7++,B0l < X7[J7][Z5l + P7 + L5l])){X7[J7][Z5l + P7 + L5l]=C7;break;}if(B0l == X7[I7 + A0l][Z5l + P7 + L5l])for((C7=B0l,J7=I7 + A0l,Z7=X7.length);J7 < Z7 && B0l == X7[J7][Z5l + P7 + L5l];J7++)(this.DelProperty(X7[J7],[Z5l + P7 + L5l]),this.DelProperty(X7[J7],[Z5l + P7 + Y5l]));}for((L7=B0l,b7=M7);;b7++){for((L7++,P7=G7);P7 <= p7;P7++)(Y7=P7 == G7?p7 - G7 + A0l:B0l,X7[b7][Z5l + P7 + L5l]=B0l,X7[b7][Z5l + P7 + Y5l]=Y7);if(X7[b7] == z7)break;}for(P7=G7;P7 <= p7;P7++)X7[M7][Z5l + P7 + L5l]=L7;}},s._getDown2Excel=function(F7,i9){var b7l="SumEndRow";var i7l="SheetFontSize";var h7l="ExcelRowHeight";var u2l="UserMerge";var S2l="BottomText";var H2l="TopBorder";var Z7l="SheetNo";var Q2l="TopText";var V7l="CellHeader";var a2l="TopFontColor";var d2l="BottomFontBold";var n5l="|visible|";var F7l="NumberFormatMode";var s2l="ExcelHeaderRowHeight";var o7l="TempFile";var f7l="xlsx";var g2l="TopFontName";var I7l="SumRow";var v2l="_";var V2l="ImageProcessType";var c2l="BottomFontSize";var k2l="BottomFontName";var n7l="ImageList";var R2l="BottomHeight";var w2l="UseFormula";var h2l="BottomBackColor";var l4l=255;var r2l="BottomBorder";var D2l="PrintSetup";var x2l="CellFormula";var i2l="BottomAlign";var S7l="SheetFontName";var O7l="Palette";var m7l="DownCombo";var v7l="AutoSizeColumn";var W7l="AppendPrevSheet";var d7l="HeaderFontColor";var Q7l="background-color";var G7l="SumStartRow";var c7l="SumBackColor";var e7l="ComboValidation";var r7l="SheetName";var T2l="BottomFontUnder";var M7l="ColVisibles";var E7l="Foot";var t7l="color";var j7l="16777215";var l7l="_IBCC";var p7l="SheetDesign";var w7l="_IBCT";var N2l="TopBackColor";var y2l="TopAlign";var E2l="TopFontUnder";var s7l=" .";var j2l="TopFontSize";var K7l="ReportXML";var t2l="TopHeight";var U2l="TopFontBold";var y7l="SumCell";var l2l="NumberExMode";var z7l="WorkbookPassword";var f2l="BottomFontColor";var H7l="ExcelFontSize";var q7l="MergeMode";var R7l="HeaderBackColor";var u7l="TextToGeneral";var Q2,T2,s2,N2,U2,R9,c9,d9,T9,k9,f9,h9,r9,m9,K9,E2=[],J2=S4l,D2=[],k2=A0l,W7=S4l,f2=S4l,M2=!A0l,h2=this,v2=B0l,H2=!A0l,t2=S4l,x2=S4l,g2=[],S2=B0l,q2=B0l,G2=B0l,b2=l5l != F7.downRows,C2=n5l == (F7.downRows + S4l).toLowerCase(),O2=F7.downHeader && F7.merge,r2=!F7.onlyHeaderMerge,p2=F7.treeLevel,l2=B0l,w2=B0l,i2=B0l,I2=[],L2=[],Y2=[],V2=S4l,j2=S4l,R2=S4l,c2=S4l,a2=this.Cols,u9=this.ImageList,B2=B0l,m2=S4l,Z2=[],n7={},z2=S4l,W2=S4l,F2=S4l,n2=S4l,y2=S4l,l9=S4l,w9=S4l,s9=S4l,V9=(V2=S4l,S4l),Q9=S4l,y9=S4l,t9=S4l,j9=S4l,U9=S4l,E9=S4l,g9=S4l,a9=S4l,A2=S4l,N9=(A2=S4l,S4l),P2=B0l,X2=B0l,d2=[];for((this.g_excelPaletteList=S4l,A0l != F7.sheetDesign && P0l != F7.sheetDesign || (M2=!B0l),N2=(g2=this.MultiRecord && this.MultiRecordShape?this._DownMultiMap[B0l]:this._getDownColNames(F7)).length,l2=B0l);l2 < this.DataRows;l2++)for((a2=this.Cols,w2=B0l);w2 < N2;w2++)(t2=(Q2=this.MultiRecord && this.MultiRecordShape?this._DownMultiMap[l2][w2]:g2[w2]) && a2[Q2] && a2[Q2].EnumKeys?(S4l + a2[Q2].EnumKeys).substring(A0l):void B0l,x2+=this._makeColumnTag(v2 + l7l,void B0l !== t2?t2:S4l),void B0l !== t2 && l4l < t2.length && (i2=A0l),t2=Q2 && a2[Q2] && a2[Q2].Enum?(S4l + a2[Q2].Enum).substring(A0l):void B0l,x2+=this._makeColumnTag(v2 + w7l,void B0l !== t2?t2:S4l),v2++,void B0l !== t2 && l4l < t2.length && (i2=A0l));if((W7+=x2,A0l === i2 && (F7.comboValidation=B0l),B0l == N2))return (this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,e8l,!A0l),-A0l);if((V2=this.GetHeaderBackColor(),j2=this.GetSumBackColor(),y2=this.GetHeaderFontColor(),S4l == V2 && (V2=-A0l == (V2=w._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(s7l + this.GetTheme() + V7l,Q7l)))?S4l:V2),S4l == j2 && (j2=-A0l == (j2=w._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(s7l + this.GetTheme() + y7l,Q7l)))?S4l:j2),S4l == y2 && (y2=-A0l == (y2=w._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(s7l + this.GetTheme() + V7l,t7l)))?S4l:y2),V2=V2.replace(/#/g,S4l),j2=j2.replace(/#/g,S4l),y2=y2.replace(/#/g,S4l),R2=parseInt(V2,L0l),c2=parseInt(j2,L0l),headerFontColorInt=parseInt(y2,L0l),R2=isNaN(R2)?j7l:R2,c2=isNaN(c2)?j7l:c2,headerFontColorInt=isNaN(headerFontColorInt)?j7l:headerFontColorInt,this._addExcelPaletteList(j2),this._addExcelPaletteList(V2),this._addExcelPaletteList(y2),this.ExcelXH=[],this.ExcelXB=[],this.ExcelXF=[],this.ExcelColsMap={},T2={from:e8l,cfg:F7,sheetDesign:M2,isTreeLevel:p2,isDownRows:b2,isDownRowVisible:C2,rowHeights:D2,downColNames:g2,downColNamesLength:N2,data:E2,p:k2,headerRows:q2,isHeaderMerge:O2},F7.downHeader && (s2=this._getHeaderData(T2),T2.p=s2.p,k2=s2.p,T2.headerRows=s2.headerRows,G2=s2.headerRows),A0l != w.g_isDirectDown2Excel && (k2=(s2=this._getBodyData(T2)).p,E2=s2.data,q2=s2.headerRows,D2=s2.rowHeights,I2=s2.sumRow,L2=s2.subSumRow,Y2=s2.cumulateRow,d2=s2.formulas),r9=(U2=this._getColInfo(F7,g2,p2)).saveName,R9=U2.align,c9=U2.type,T9=U2.format,d9=U2.orgFormat,k9=U2.width,f9=U2.visible,h9=U2.datePattern,F7.merge)){for((B0l == this.SearchMode && (this.DownMergeSheet=!B0l),l2=B0l,i2=this.getCols().length);l2 < i2;l2++){if((H2=!A0l,Q2=this.getCols()[l2],this.Cols[Q2].Visible))for(w2=B0l;w2 < N2;w2++)Q2 == g2[w2] && (H2=!B0l);else for((H2=!B0l,w2=B0l);w2 < N2;w2++)if(Q2 == g2[w2]){H2=!A0l;break;}if(!(m9=H2))break;}((w.g_isDirectDown2Excel || b2 || C2) && (r2=!A0l),U7l == this.MainCol && (r2=!A0l),S2=B0l,F7.downHeader || (S2=this.getHeaderRows().length),this.Rows.FormulaRow && E7l == this.Rows.FormulaRow.Fixed && this.Rows.FormulaRow.Visible && !F7.downSum && S2++,this.Rows.Filter && this.Rows.Filter.Visible && S2++,(O2 || r2) && (!w.g_isDirectDown2Excel && this.DownMergeSheet && (!this.HeaderMerge && !this.DataMerge || this.SubSumRowsArray?this.SubSumRowsArray && this.setMergeSubTotal():this.setAutoMerge(this.DataMerge,this.HeaderMerge,this.PrevColumnMerge)),J2=this._getExcelMergeInfo(g2,O2,r2,q2,m9,S2,F7.downSum)));}for((l2=B0l,K9=u9.length);l2 < K9;l2++)(B2=l2,-A0l != (m2=this.GetImageList(B2)) && (m2=w._ibsUtil.getFullPath(m2),Z2.push(B2 + g7l + m2)));(F7.header && I4l == typeof F7.header && (z2=(n7=this._getTitleConfig(F7.header)).text,W2=n7.align,F2=n7.height,n2=n7.fontBold,y2=n7.fontColor,l9=n7.fontName,w9=n7.fontSize,s9=n7.fontUnderline,V2=n7.backColor,V9=n7.border,P2=!B0l),F7.footer && I4l == typeof F7.footer && (Q9=(n7=this._getTitleConfig(F7.footer)).text,y9=n7.align,t9=n7.height,j9=n7.fontBold,U9=n7.fontColor,E9=n7.fontName,g9=n7.fontSize,a9=n7.fontUnderline,A2=n7.backColor,N9=n7.border,X2=!B0l),this.ExcelXH=j4l,this.ExcelXB=j4l,this.ExcelXF=j4l,this.fileDownloadCheckToken=new Date().getTime(),w.g_isDown2ExcelBuffer?w.g_isDown2ExcelBufferToken?this.fileDownloadCheckToken=w.g_isDown2ExcelBufferToken:w.g_isDown2ExcelBufferToken=this.fileDownloadCheckToken:w.fileDownloadCheckTimer=Q.setInterval(function(){h2._getCookie(s5l) == h2.fileDownloadCheckToken && (h2.fileDownloadCheckToken=j4l,h2._finishDownload());},F0l),W7+=this._makeColumnTag(a7l,this.fileDownloadCheckToken),(f2=location.href.substring(location.href.indexOf(o4l) + P0l).split(N7l))[B0l]=S4l,f2[f2.length - A0l]=S4l,B0l < F7.excelFontSize && (W7+=this._makeColumnTag(H7l,F7.excelFontSize)),A0l != F7.sheetDesign && P0l != F7.sheetDesign || (W7+=this._makeColumnTag(S7l,this.GetSheetFontName()),W7+=this._makeColumnTag(i7l,this.GetSheetFontSize()),W7+=this._makeColumnTag(R7l,R2),W7+=this._makeColumnTag(c7l,c2),W7+=this._makeColumnTag(d7l,headerFontColorInt)),W7+=this._makeColumnTag(T7l,f2.join(N7l)),W7+=this._makeColumnTag(k7l,w._ibsUtil.getFileName(F7.fileName,f7l)),W7+=this._makeColumnTag(U5l,F7.extendParam),W7+=this._makeColumnTag(h7l,F7.excelRowHeight),W7+=this._makeColumnTag(r7l,F7.sheetName),W7+=this._makeColumnTag(m7l,F7.downCombo),W7+=this._makeColumnTag(K7l,F7.reportXML),W7+=this._makeColumnTag(u7l,F7.textToGeneral?A0l:B0l),W7+=this._makeColumnTag(D7l,F7.wordWrap?A0l:B0l),W7+=this._makeColumnTag(v7l,F7.autoSizeColumn?A0l:B0l),W7+=this._makeColumnTag(x7l,R9),W7+=this._makeColumnTag(v5l,J2),W7+=this._makeColumnTag(q7l,F7.merge),W7+=this._makeColumnTag(k5l,r9),W7+=this._makeColumnTag(O7l,this.g_excelPaletteList),W7+=this._makeColumnTag(a5l,G2),W7+=this._makeColumnTag(B7l,c9),W7+=this._makeColumnTag(A7l,T9),W7+=this._makeColumnTag(P7l,d9),W7+=this._makeColumnTag(u5l,h9),W7+=this._makeColumnTag(X7l,k9),W7+=this._makeColumnTag(J7l,D2.join(n8l)),W7+=this._makeColumnTag(M7l,f9),W7+=this._makeColumnTag(G7l,B0l),W7+=this._makeColumnTag(b7l,B0l),W7+=this._makeColumnTag(C7l,F7.downHeader?A0l:B0l),W7+=this._makeColumnTag(p7l,B0l < F7.sheetDesign && F7.sheetDesign < J0l?F7.sheetDesign:B0l),W7+=this._makeColumnTag(e7l,F7.comboValidation?A0l:B0l),W7+=this._makeColumnTag(I7l,I2.join(b4l)),W7+=this._makeColumnTag(L7l,L2.join(b4l)),W7+=this._makeColumnTag(Y7l,Y2.join(b4l)),W7+=this._makeColumnTag(o7l,F7.tempFile),F7.tempFile && (W7+=this._makeColumnTag(Z7l,F7.sheetNo),W7+=this._makeColumnTag(N5l,F7.startRow),W7+=this._makeColumnTag(S5l,F7.startCol)),W7+=this._makeColumnTag(z7l,this._encodeBase64(F7.workbookPassword)),W7+=this._makeColumnTag(W7l,F7.appendPrevSheet),W7+=this._makeColumnTag(F7l,F7.numberFormatMode),W7+=this._makeColumnTag(n7l,Z2.join(n8l)),W7+=this._makeColumnTag(W7l,F7.appendPrevSheet),W7+=this._makeColumnTag(l2l,F7.numberExMode?A0l:B0l),W7+=this._makeColumnTag(w2l,F7.useFormula?A0l:B0l),W7+=this._makeColumnTag(s2l,F7.excelHeaderRowHeight),W7+=this._makeColumnTag(V2l,F7.imageProcessType),P2 || X2?(P2 && (W7+=this._makeColumnTag(Q2l,z2),W7+=this._makeColumnTag(y2l,W2),W7+=this._makeColumnTag(t2l,F2),W7+=this._makeColumnTag(j2l,w9),W7+=this._makeColumnTag(U2l,n2),W7+=this._makeColumnTag(E2l,s9),W7+=this._makeColumnTag(g2l,l9),W7+=this._makeColumnTag(a2l,y2 || GetStyle(this.getCell(this.Header,this.getFirstCol())).color),W7+=this._makeColumnTag(N2l,V2),W7+=this._makeColumnTag(H2l,V9)),X2 && (W7+=this._makeColumnTag(S2l,Q9),W7+=this._makeColumnTag(i2l,y9),W7+=this._makeColumnTag(R2l,t9),W7+=this._makeColumnTag(c2l,g9),W7+=this._makeColumnTag(d2l,j9),W7+=this._makeColumnTag(T2l,a9),W7+=this._makeColumnTag(k2l,E9),W7+=this._makeColumnTag(f2l,U9),W7+=this._makeColumnTag(h2l,A2),W7+=this._makeColumnTag(r2l,N9))):(W7+=this._makeColumnTag(m2l,F7.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH)),W7+=this._makeColumnTag(K2l,F7.titleAlign.toLowerCase()),W7+=this._makeColumnTag(u2l,F7.userMerge)));var H9=S4l;if(F7.printSetup && I4l == typeof F7.printSetup){var S9=B0l;for(var K2 in F7.printSetup)(H9+=(B0l < S9?n8l:S4l) + (K2.charAt(B0l).toUpperCase() + K2.slice(A0l,K2.length)) + g7l + F7.printSetup[K2],S9+=A0l);}W7+=this._makeColumnTag(D2l,H9);var u2=S4l;if(F7.useFormula && B0l < d2.length)for(l2=B0l;l2 < d2.length;l2++)(B0l < l2 && (u2+=C4l),u2+=d2[l2].SaveName,u2+=v2l + d2[l2].Formula);if((W7+=this._makeColumnTag(x2l,u2),W7+=this.IB_DELIMITER_ROW,E2[B0l]=W7,w.g_isDown2ExcelBuffer))(E2[k2++]=this.IB_DELIMITER_SHEET,w.g_down2ExcelBuffer+=E2.join(S4l),w.g_Multipart=F7.multipart);else {if(F7.debugMode)return E2.join(S4l);i9 && i9(E2.join(S4l));}delete this.DownMergeSheet;},s._getExcelMergeInfo=function(M9,t6,j6,n9,V6,U6,E6){var q2l="Head";var A2l="_RowSpan";var P2l="_Span";var x9,A9,P9,D9,O9,B9,o9,l6,X9,Z9,Q6,q9=[],w6={},I9=B0l,J9=B0l,b9=B0l,C9=B0l,z9=B0l,p9=B0l,L9=B0l;for((Q6=(this.Rows.FormulaRow && this.Rows.FormulaRow.Visible && q2l == this.Rows.FormulaRow.Fixed?A0l:B0l) + (this.Rows.Filter.Visible?A0l:B0l) + this.getHeaderRows().length,this.ExcelCol=[],this.ExcelColMerge=[],x9=B0l,P9=M9.length);x9 < P9;x9++)(this.ExcelCol.push(Z5l + (x9 + A0l)),this.ExcelColMerge.push(M9[x9]?this.Cols[M9[x9]].ColMerge:void B0l),w6[M9[x9]]=x9);if(t6)for((this._excelHeaderMergeRange(),x9=B0l,P9=this.ExcelXH.length);x9 < P9;x9++)if(C5l !== (D9=this.ExcelXH[x9]).id && O2l != D9.id)for((A9=B0l,J9=M9.length);A9 < J9;A9++)(O9=x9,B9=(v9=this.ExcelCol[A9]).substr(A0l,v9.length) - A0l,B0l < D9[v9 + L5l] && B0l < D9[v9 + Y5l]?(q9.push(O9 + b4l + B9),q9.push(O9 + D9[v9 + L5l] - A0l + b4l + (B9 + D9[v9 + Y5l] - A0l) + n8l)):this.MultiRecord && this.MultiRecordShape && (A0l < D9[v9 + L5l] || A0l < D9[v9 + Y5l]) && (q9.push(O9 + b4l + B9),q9.push(O9 + (A0l < D9[v9 + L5l]?D9[v9 + L5l] - A0l:B0l) + b4l + (B9 + (A0l < D9[v9 + Y5l]?D9[v9 + Y5l] - A0l:B0l)) + n8l)));if(j6)if(V6){var s6=B0l;for(D9=this.getFirstRow();D9;D9=this.getNextRow(D9))if(C5l !== D9.id && O2l != D9.id){(p9=z9=C9=b9=B0l,O9=(j4l == (O9=this.getRowIndex(D9))?s6++:O9 + s6 - A0l) + Q6 - U6);for(var W9=B0l;W9 < M9.length;W9++){var v9;if(B2l != (v9=M9[W9]) || this.Cols.SEQ.Visible){(void B0l === w6[v9]?(L9=!B0l,b9++):L9=!A0l,B9=this.getColIndex(v9) - A0l);var G9=this.DownMergeSheet?D9[v9 + A2l]:D9[v9 + L5l],e9=this.DownMergeSheet?D9[v9 + P2l]:D9[v9 + Y5l];((G9 || D9[v9 + Y5l]) && (A0l < G9 || A0l < e9) && (o9=b9,L9 && (o9=b9 - A0l),l6=B0l < B9 - o9?B9 - o9:B0l,B0l !== G9 && e9 && q9.push(O9 + b4l + l6),A0l == e9 && (L9?q9.pop():q9.push(O9 + G9 - A0l + b4l + l6 + n8l)),B0l !== G9 && A0l < e9 && (C9=B9,z9=O9 + G9 - A0l,p9=e9)),p9 && (C9++,--p9 <= B0l && (q9.push(z9 + b4l + (C9 - A0l - b9) + n8l),p9=C9=B0l)),D9[v9 + A2l] && delete D9[v9 + A2l],D9[v9 + P2l] && delete D9[v9 + P2l]);}}}}else for((A0l < this.DataRows && X0l == this.DataMergeAction?this._excelDataFixedMergeRange():this._excelDataMergeRange(),x9=X9=B0l,P9=this.ExcelXB.length);x9 < P9;x9++)if(C5l !== (D9=this.ExcelXB[x9]).id && O2l != D9.id){for((A9=B0l,J9=this.ExcelCol.length);A9 < J9;A9++)(O9=X9 + n9,B9=(v9=this.ExcelCol[A9]).substr(A0l,v9.length) - A0l,B0l < D9[v9 + L5l] && B0l < D9[v9 + Y5l]?(q9.push(O9 + b4l + B9),q9.push(O9 + D9[v9 + L5l] - A0l + b4l + (B9 + D9[v9 + Y5l] - A0l) + n8l)):this.MultiRecord && this.MultiRecordShape && (A0l < D9[v9 + L5l] || A0l < D9[v9 + Y5l]) && (q9.push(O9 + b4l + B9),q9.push(O9 + (A0l < D9[v9 + L5l]?D9[v9 + L5l] - A0l:B0l) + b4l + (B9 + (A0l < D9[v9 + Y5l]?D9[v9 + Y5l] - A0l:B0l)) + n8l)));X9++;}if(E6)if((Z9=(Z9=B0l) == this.GetAutoSumPosition()?n9 - A0l:this.ExcelXB.length + n9,V6))for((x9=X9=B0l,P9=this.ExcelXF.length);x9 < P9;x9++){for((D9=this.ExcelXF[x9],A9=B0l,J9=this.ExcelCol.length);A9 < J9;A9++)if((O9=X9 + Z9,B9=(v9=this.ExcelCol[A9]).substr(A0l,v9.length) - A0l,B0l < D9[v9 + L5l] && B0l < D9[v9 + Y5l])){var Y9=D9[v9 + Y5l],y6=B9 + Y9;if(B0l < D9[v9 + Y5l])for(I9=P0l;I9 <= D9[v9 + Y5l];I9++){var F9=D9[Z5l + (B9 + I9) + o5l];F9 && F9.substr(A0l,F9.length) > y6 && Y9--;}B0l < D9[v9 + L5l] && B0l < Y9 && (q9.push(O9 + b4l + B9),q9.push(O9 + D9[v9 + L5l] - A0l + b4l + (B9 + Y9 - A0l) + n8l));}X9++;}else for((x9=X9=B0l,P9=this.ExcelXF.length);x9 < P9;x9++){for((D9=this.ExcelXF[x9],A9=B0l,J9=this.ExcelCol.length);A9 < J9;A9++)(O9=X9 + Z9,B9=(v9=this.ExcelCol[A9]).substr(A0l,v9.length) - A0l,B0l < D9[v9 + L5l] && B0l < D9[v9 + Y5l] && (q9.push(O9 + b4l + B9),q9.push(O9 + D9[v9 + L5l] - A0l + b4l + (B9 + D9[v9 + Y5l] - A0l) + n8l)));X9++;}for(x9=B0l;x9 < q9.length;x9+=P0l)q9[x9].replace(/\|/g,S4l) == q9[x9 + A0l].replace(/\|/g,S4l) && q9.splice(x9,P0l);return ((q9=(q9=q9.join(b4l)).replace(/\|\,/g,F8l)) && n8l == q9.substring(q9.length - A0l) && (q9=q9.substring(B0l,q9.length - A0l)),this.ExcelXH=j4l,this.ExcelXB=j4l,this.ExcelXF=j4l,this.ExcelCol=j4l,this.ExcelColMerge=j4l,q9);},s._getExcelRowHeight=function(a6,N6){var g6;return (B0l != (g6=this.GetExcelRowHeight(a6,N6)) && g6 != this.InvalidValue || (g6=this.GetDataRowHeight()),g6);},s._getStringExcel=function(S6,i6,D6,f6,v6){var n2l="Img";var Y2l=/\-/;var G2l="BLANK";var l9l="g";var o2l=/\:/;var C2l="***";var L2l=/\-|\/|\./;var F2l="CODE";var V9l="GR";var h6=B0l,m6=B0l,K6=S4l,H6=S4l,c6=this.getAttribute(S6,i6,X2l) || this.getAttribute(S6,i6,J2l),R6=this.getType(S6,i6);if(M2l == v6)return d6(this._getCellText(S6,i6));if(this._isNumberType(R6) && !f6.numberTypeToText)return (H6=this._getCellValue(S6,i6),!i6 || B2l != i6 || H6 || S6.Visible && !S6.Hidden || (H6=G2l),d6(H6));if(D6){if(b2l === R6)return C2l;if(p2l == R6){var r6=j4l,k6=H6=this._getCellValue(S6,i6);(S4l + (c6=(c6=c6 || this.getAttribute(S6,i6,e2l) || this.DateFormat || this.getAttribute(S6,i6,g5l) || this.DataFormat) && c6.replace(/[h]/g,I2l))).match(L2l) && (r6=c6.replace(/\-|\/|\./gi,S4l),k6=k6.replace(/\-|\/|\./gi,S4l));var T6=w.stringToDate(S4l + k6,H6.match(Y2l) || !r6 && k6.match(o2l)?j4l:r6 || c6);(Q8l == typeof (H6=isNaN(T6)?H6:T6) && H6.match(o2l) && (T6=w.stringToDate(H6,Z2l),isNaN(T6) || (H6=T6)),Q8l == typeof (H6=w.dateToString(H6,c6)) && (H6=this._removeHTMLTag(H6)));}if(z2l === R6)return this.Grouped && this.GroupTreeCols && this.GroupTreeCols[i6] && !S6.Def.Group?S4l:H6=M8l == this.getValue(S6,i6)?f6.checkBoxOnValue:f6.checkBoxOffValue;if(W2l === R6)return F2l == f6.downCombo?d6(this._getCellValue(S6,i6)):d6(this._getCellText(S6,i6));if(n2l === R6 && (H6=this._getCellText(S6,i6),!w._ibsUtil.isEmpty(H6)))return H6=(H6=w._ibsUtil.getFullPath(H6)).replace(new RegExp(w._ibsUtil.escapeRegExp(w._ibsUtil.getDomain()),l9l),S4l);if(w9l === R6)return this._getCellText(S6,i6);if(s9l === R6)return this._removeHTMLTag(this._getCellText(S6,i6));}function d6(x6){return (Q8l == typeof x6 && (x6=x6.replace(/[\x00]/g,S4l)),x6);}if(B0l == S6.id.indexOf(V9l) && i6 == this.GroupMain && b5l == S6.Kind){var u6=this.getSpanned(S6,i6);H6=this._getCellText(u6[B0l],u6[A0l]);}else H6=this._getCellText(S6,i6);if(S4l == H6 && (S6.SubSumRow || S6.CumulateRow) && Q9l == this.Cols[i6].Type)return d6(S6[i6]);if(D6 && this.MainCol == i6){for((h6=B0l,m6=A0l * S6.Level);h6 <= m6;h6++)K6+=this.IB_DELIMITER_TREE_INDENT;H6=K6 + H6;}return d6(H6);},s._sendDown=function(L6,I6,J6,M6,Z6,A6,z6,Y6){var a9l="IBSheetDown2ExcelFrm";var m9l="load";var y9l="IBSheetDown2ExcelFrame";var O6,q6,B6,o6,P6=y9l,G6=B0l,p6=[],e6=[],b6=S4l,C6=S4l,X6=!A0l;w.g_down2ExcelBuffer=j4l;GetWindowScroll();if(z6)return (this.hideMessage(),L6 + this.IB_DELIMITER_END);if((e8l == A6?b6=A0l == w.g_isDirectDown2Excel?t9l:j9l:G8l == A6?b6=U9l:E9l == A6 && (b6=g9l),(q6=V.getElementById(a9l)) && V.body.removeChild(q6),(q6=V.createElement(N9l)).id=a9l,q6.method=H9l,Z6 && (q6.encoding=S9l,q6.enctype=S9l),(B6=V.createElement(i9l)).type=R9l,B6.name=b5l,B6.value=L6 + this.IB_DELIMITER_END,q6.appendChild(B6),void B0l === J6 && (M6=S4l),M6=void B0l === M6?c9l:M6.toLowerCase(),C6=I6,C6+=(B0l <= I6.indexOf(d9l)?T9l:d9l) + k9l + b6,f9l == M6)){if((q6.action=C6,J6))for((e6=J6.split(T9l),G6=B0l);G6 < e6.length;G6++)(p6=(e6[G6] + g7l).split(g7l),(B6=V.createElement(i9l)).type=R9l,B6.name=p6[B0l],B6.value=p6[A0l],q6.appendChild(B6));}else q6.action=C6 + (S4l != J6?T9l:S4l) + J6;((O6=V.createElement(h9l)).name=P6,O6.id=P6,O6.width=r9l,O6.height=r9l,O6.addEventListener(m9l,(function(){Y6 && Q.setTimeout((function(){w.fileDownloadCheckTimer && (Q.clearInterval(w.fileDownloadCheckTimer),w.fileDownloadCheckTimer=j4l,O6.parentNode.removeChild(O6),this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));}).bind(this),Y6);}).bind(this)),q6.target=P6,q6.appendChild(O6),V.body.appendChild(q6),q6.style.display=K9l,q6.style.width=r9l,q6.style.height=r9l,Q.frames[P6].name=P6,o6=this._checkCrossDomain(I6),w.OnBeforeDownload && (X6=w.OnBeforeDownload(this,A6,q6)),X6 || e8l != A6 || w.OnReadyExcelDown && (X6=w.OnReadyExcelDown(this,q6)),X6 || q6.submit(),!w.fileDownloadCheckTimer || this.fileDownloadCheckToken && !o6 || (Q.clearInterval(w.fileDownloadCheckTimer),w.fileDownloadCheckTimer=j4l,this.hideMessage(),!X6 && IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,A6,!B0l)));},s.Down2Hml=function(W6){var x9l="Down2Hml.jsp";var D9l="_IBSheet";var u9l="portrait";var v9l="landscape";var F6,s1=this,w1=S4l,n6=S4l,l1=p8l;return (this.showMessage(this.getMessage(J8l),(this.SuppressMessage || B0l) + A0l,A0l),W6=w._ibsUtil.cloneArray(W6),F6=this.Down2HmlConfig || ({}),this._prepareExportSetting(),I4l == typeof W6.title && (n6=W6.title.text,l1=W6.title.align),W6.title || I4l != typeof W6.Title || (n6=W6.Title.Text,l1=W6.Title.Align),W6.docOrientation=this._getDefault(W6.docOrientation || W6.DocOrientation,F6.docOrientation || u9l),W6.downCols=this._getDefault(W6.downCols || W6.DownCols,F6.downCols || S4l),W6.downSum=this._getDefault(W6.downSum || W6.DownSum,F6.downSum || A0l),W6.extendParam=this._getDefault(W6.extendParam || W6.ExtendParam,F6.extendParam || S4l),W6.fileName=this._getDefault(W6.fileName || W6.FileName,F6.fileName || D9l),W6.titleAlign=this._getDefault(l1,F6.titleAlign || p8l),W6.titleText=this._getDefault(n6,F6.titleText || S4l),v9l !== W6.docOrientation.toLowerCase() && (W6.docOrientation=u9l),W6.downTreeHide=!A0l,w1=void B0l !== this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:x9l,this._getDown2Hml(W6,function(V1){s1._sendDown(V1,w1,W6.extendParam,f9l,A0l,M2l);}));},s.GetDown2HmlUrl=function(){var Q1=S4l;return (this.Source.Down2Hml.Url && (Q1=this.Source.Down2Hml.Url),Q1);},s.SetDown2HmlUrl=function(y1){(this.Source.Down2Hml || (this.Source.Down2Hml={}),this.Source.Down2Hml.Url=y1);},s._getDown2Hml=function(j1,c1){var O9l="DocOrientation";var q9l="hml";var i1,d1,T1,E1,k1,f1,h1,m1,K1,u1,g1=[],R1=[],S1=A0l,t1=S4l,N1=S4l,H1=this,a1={},U1={};return B0l == (d1=(i1=this._getDownColNames(j1)).length)?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,M2l,!A0l),-A0l):(a1={from:M2l,cfg:j1,sheetDesign:B0l,isTreeLevel:B0l,isDownRows:B0l,isDownRowVisible:B0l,rowHeights:[],downColNames:i1,downColNamesLength:d1,data:g1,p:S1,headerRows:B0l,isHeaderMerge:B0l},U1=this._getHeaderData(a1),a1.p=U1.p,S1=U1.p,a1.headerRows=U1.headerRows,T1=U1.headerRows,S1=(U1=this._getBodyData(a1)).p,g1=U1.data,R1=U1.rowHeights,k1=(E1=this._getColInfo(j1,i1,B0l)).type,h1=E1.format,f1=E1.orgFormat,K1=E1.width,m1=E1.align,u1=E1.datePattern,this.fileDownloadCheckToken=new Date().getTime(),w.fileDownloadCheckTimer=Q.setInterval(function(){H1._getCookie(s5l) == H1.fileDownloadCheckToken && (H1.fileDownloadCheckToken=j4l,H1._finishDownload(M2l));},F0l),t1+=this._makeColumnTag(a7l,this.fileDownloadCheckToken),(N1=location.href.substring(location.href.indexOf(o4l) + P0l).split(N7l))[B0l]=S4l,N1[N1.length - A0l]=S4l,t1+=this._makeColumnTag(T7l,N1.join(N7l)),t1+=this._makeColumnTag(k7l,w._ibsUtil.getFileName(j1.fileName,q9l)),t1+=this._makeColumnTag(U5l,j1.extendParam),t1+=this._makeColumnTag(a5l,T1),t1+=this._makeColumnTag(B7l,k1),t1+=this._makeColumnTag(A7l,h1),t1+=this._makeColumnTag(P7l,f1),t1+=this._makeColumnTag(u5l,u1),t1+=this._makeColumnTag(x7l,m1),t1+=this._makeColumnTag(X7l,K1),t1+=this._makeColumnTag(J7l,R1.join(n8l)),t1+=this._makeColumnTag(m2l,j1.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH)),t1+=this._makeColumnTag(K2l,j1.titleAlign.toLowerCase()),t1+=this._makeColumnTag(O9l,j1.docOrientation.toLowerCase()),t1+=this.IB_DELIMITER_ROW,g1[B0l]=t1,j1.debugMode || j1.DebugMode?(this.hideMessage(),g1.join(S4l)):void (V8l == typeof c1 && c1(g1.join(S4l))));},s.Down2Pdf=function(D1){var B9l="clone";var X9l="converter";var J9l="itextpdf";var M9l="wkhtmltopdf";var P9l="unset";D1=D1 || ({});var x1,q1=this.GetFnLib(B9l),O1=this.GetFnLib(c9l),B1=this.GetFnLib(A9l),A1=this.GetFnLib(P9l),v1=q1(D1.pdf) || ({}),P1=O1(v1,X9l) || J9l;switch((A1(v1,X9l),P1)){case M9l:x1=this.GetWKHtml2PDF(v1);break;case J9l:default:x1=this.GetITextHtml2PDF(v1);}return (B1(D1,G9l,{finish:x1}),this.doPrint(D1));},s.GetDown2PdfUrl=function(){var X1=S4l;return (this.Source.Down2Pdf.Url && (X1=this.Source.Down2Pdf.Url),X1);},s.GetITextHtml2PDF=function(M1){var l6l="wordWrap";var n9l="mode";var V4l=32800;var s6l="dpi";var j6l="title";var U6l="Title";var H6l="URL";var i6l="ExtendParamMethod";var M6l=2e3;var c6l="ExtendParam]";var g6l="TitleStyle";var t6l="FontTo";var E6l="titleStyle";var S6l="extendParamMethod";var o0l=50;var V6l="Dpi";var w6l="fileName";var Q6l="DPI";var z1,J1=this,n1=this.GetFnLib(c9l),l3=this.GetFnLib(A9l),G1=this.GetFnLib(b9l),w3=this.GetFnLib(C9l),s3=this.GetFnLib(p9l),W1=this.GetFnLib(e9l),F1=this.GetFnLib(I9l),V3=this.GetFnLib(L9l),Q3=this.GetFnLib(Y9l),y3=this.GetFnLib(o9l);function Z1(d3,c3,R3){return Z9l + c3 + (R3=j4l != R3?(W1(R3) && (R3=R3.join(F8l).replace(/\s+/g,F8l)),F8l + R3):S4l) + z9l + d3 + W9l + c3 + z9l;}(J1._prepareExportSetting(),j4l == M1 && (M1={FileName:F9l,objReturn:A0l}),w3([[n9l,c5l],[l6l,D7l],[w6l,k7l],[s6l,V6l,Q6l],[y6l,t6l],[j6l,U6l],[E6l,g6l],[a6l,N6l,H6l],[S6l,i6l],[R6l,c6l]],function(S3){var H3,i3;for(H3=A0l;H3 < S3.length;H3+=A0l)(i3=S3[H3],G1(M1,i3) && (M1[S3[B0l]]=M1[i3]));}),(G1(M1,d6l) || G1(M1,T6l)) && (J1.showMessage(J1.getMessage(J8l),(J1.SuppressMessage || B0l) + A0l,A0l),z1=!B0l),G1(M1,n9l) || (M1.mode=B0l));var Y1=b1(l6l);function j3(k3){var f3=L1(k3,k6l),h3=F1([f6l,[h6l,r6l]],function(m3){s3(m3) && (m3=[m3,m3]);var K3=L1(f3,m3[B0l]);return j4l == K3?S4l:(W1(K3) && (K3=K3.join(F8l)),m3[A0l] + m6l + K3 + k8l);}),r3=(function(){var K6l='style="font-family:';var u3=b1(j6l);if(j4l == u3)return S4l;var D3=b1(E6l,S4l);return Z1(u3,L4l,[K6l + I1 + u6l + D3 + k8l]) + D6l;})(),T3=L1(k3,v6l,S4l);return (T3.length && (T3=T3.replace(new RegExp(x6l,q6l),D6l).replace(new RegExp(O6l,q6l),F8l).replace(new RegExp(B6l,q6l),A6l).replace(new RegExp(J1.Style + P6l,q6l),S4l).replace(new RegExp(J1.Style + X6l,q6l),S4l)),Z1(r3+=T3,J6l,h3));}(Y1=J1._getBooleanValue(Y1,B0l),l3(M1,l6l,Y1),J1.PdfWordWrap=B0l);function b1(a3,N3){return L1(M1,a3,N3);}var t3=b1(w6l,F9l),C1=M6l;G1(M1,s6l) && (C1=(C1=J1._getNumberValue(M1.dpi,C1)) < o0l?o0l:V4l < C1?V4l:C1);var I1=G6l;function L1(U3,E3,g3){return G1(U3,E3)?n1(U3,E3):j4l != g3?g3:void B0l;}G1(M1,y6l) && (I1=(function(O3){var v3=b1(y6l);v3=v3 && y3(v3);var x3={gulim:b6l,gothic:G6l},q3=Q3(x3);return V3(q3,v3)?x3[v3]:O3;})(I1));return function(A3){(J1.fileDownloadCheckToken=new Date().getTime(),w.fileDownloadCheckTimer=setInterval(function(){J1._getCookie(s5l) == J1.fileDownloadCheckToken && (J1.fileDownloadCheckToken=j4l,J1._finishDownload(E9l));},F0l));var P3=w._ibsUtil.getFileName,X3=J1._makeColumnTag,J3=F1([[a7l,J1.fileDownloadCheckToken],[k7l,P3(t3,G9l)],[Q6l,C1]],function(C3){return X3.apply(J1,C3);}),B3=[J3+=J1.IB_DELIMITER_ROW,Z1([(function(p3){return (p3=p3 || S4l,Z1(p3+=C6l + I1 + p6l,e6l));})(A3.head || S4l),j3(A3.body || j4l)].join(a8l),v6l,I6l)].join(a8l);if(z1)return B3;var M3=b1(a6l,J1.Source.Down2Pdf.Url),G3=b1(R6l,S4l),b3=b1(S6l,f9l).toLowerCase();return J1._sendDown(B3,M3,G3,b3,!B0l,E9l,z1);};},s.GetWKHtml2PDF=function(Z3){var Y6l="https://api.ibleaders.com";var o6l="ibleaders/v8";var L6l="export/wkhtml2pdf.jsp";function l02(c02,R02,i02){return Z9l + R02 + (i02=j4l != i02?(F3(i02) && (i02=i02.join(F8l).replace(/\s+/g,F8l)),F8l + i02):S4l) + z9l + c02 + W9l + R02 + z9l;}function Y3(g02,a02,N02){return L3(g02,a02)?s02(g02,a02):j4l != N02?N02:void B0l;}var I3=this,W3=L6l,w02=[Y6l,o6l,W3].join(N7l),s02=this.GetFnLib(c9l),V02=this.GetFnLib(A9l),L3=this.GetFnLib(b9l),Q02=this.GetFnLib(C9l),y02=this.GetFnLib(p9l),F3=this.GetFnLib(e9l),t02=this.GetFnLib(I9l),j02=this.GetFnLib(L9l),U02=this.GetFnLib(Y9l),E02=this.GetFnLib(o9l);(I3._prepareExportSetting(),L3(Z3,d6l) || L3(Z3,T6l));function n3(H02,S02){return Y3(Z3,H02,S02);}var z3=G6l;L3(Z3,y6l) && (z3=(function(f02){var d02=n3(y6l);d02=d02 && E02(d02);var T02={gulim:b6l,gothic:G6l},k02=U02(T02);return j02(k02,d02)?T02[d02]:f02;})(z3));return function(K02){var y1l="Content-Type";var V1l="PrintDPI";var Q1l="requestURL:";var l1l="PDFPageOrientation";var Y0l=40;var Z6l=/Down2Pdf\.jsp$/;var n6l="PDFPageSize";var z6l="PDFName";var W6l="File";var F6l="PDFFormat";var t1l="application/x-www-form-urlencoded";var s1l="PrintMarginHeight";var j1l="blob";var w1l="PrintMarginWidth";var W0l=96;(I3.fileDownloadCheckToken=new Date().getTime(),w.fileDownloadCheckTimer=setInterval(function(){I3._getCookie(s5l) == I3.fileDownloadCheckToken && (I3.fileDownloadCheckToken=j4l,I3._finishDownload(E9l));},F0l));var r02=n3(a6l);j4l == r02 && (r02=Y3(I3.Source.Down2Pdf,N6l,w02),Z6l.test(r02) && (r02=r02.replace(Z6l,W3)));var m02=n3(R6l,{});Q02([{name:z6l,defaultValue:F9l},{name:W6l,defaultValue:F9l},{name:F6l,defaultValue:G9l},{name:n6l,defaultValue:C0l},{name:l1l,defaultValue:B0l},{name:w1l,defaultValue:Y0l},{name:s1l,defaultValue:Y0l},{name:V1l,defaultValue:W0l}],function(v02){var D02=v02.name;L3(m02,D02) || V02(m02,D02,v02.defaultValue);});var u02=l02([(function(x02){return (x02=S4l,l02(x02+=C6l + z3 + p6l,e6l));})(K02.head || S4l),(function(O02){var B02=Y3(O02,k6l),A02=t02([f6l,[h6l,r6l]],function(P02){y02(P02) && (P02=[P02,P02]);var X02=Y3(B02,P02[B0l]);return j4l == X02?S4l:(F3(X02) && (X02=X02.join(F8l)),P02[A0l] + m6l + X02 + k8l);}),q02=Y3(O02,v6l,S4l);return (q02.length && (q02=q02.replace(new RegExp(x6l,q6l),D6l).replace(new RegExp(O6l,q6l),F8l).replace(new RegExp(B6l,q6l),A6l).replace(new RegExp(I3.Style + P6l,q6l),S4l).replace(new RegExp(I3.Style + X6l,q6l),S4l)),l02(q02,J6l,A02));})(K02.body || j4l)].join(a8l),v6l,I6l);m02.Data=u02;var h02=new XMLHttpRequest();(console.log(Q1l,r02),h02.open(f9l.toUpperCase(),r02),h02.setRequestHeader(y1l,t1l),h02.responseType=j1l,h02.onload=function(){var E1l="a";var U1l="[Success] PDF FileSize:";var g1l=".pdf";var n0l=200;var a1l="[Failed] Returned status of ";if(n0l === h02.status){var M02=h02.response;console.log(U1l,M02.size);var J02=V.createElement(E1l);(J02.href=Q.URL.createObjectURL(M02),J02.download=m02.File + g1l,J02.click());}else (console.log(a1l + h02.status,h02.statusText),console.log(h02.statusText));});try{h02.send((function(C02){var G02=S4l;for(var b02 in C02)C02.hasOwnProperty(b02) && (B0l < G02.length && (G02+=T9l),G02+=encodeURI(b02 + g7l + C02[b02]));return G02;})(m02));}catch(p02){console.log(p02);}};},s.SetDown2PdfUrl=function(e02){(this.Source.Down2Pdf || (this.Source.Down2Pdf={}),this.Source.Down2Pdf.Url=e02);},s._autoExcelModeCheck=function(I02,W02,L02,F02,Z02,n02){var d1l="xls|xlsx|txt|csv";var H1l=".txt";var R1l="txt|csv";var S1l=".csv";var i1l="xls|xlsx";var Y02,o02=!A0l,z02=S4l;if((A0l == (Y02=this._getNumberValue(W02,A0l,B0l,A0l,X0l)) && (o02=!B0l),void B0l === I02 && (I02={}),F02)){if(P0l == Y02 || X0l == Y02)if(Z02 || X0l != Y02 || N1l != typeof JSZip){if(void B0l !== n02)return !A0l;if(e8l == L02){if(Z02)return !B0l;this.exportData(I02);}else G8l == L02 && (-A0l == I02.fileName.indexOf(H1l) && -A0l == I02.fileName.indexOf(S1l) && (I02.fileName=I02.fileName.concat(H1l)),this.exportData(I02));}else w.BIEA && !w.BIEA10?o02=!B0l:e8l == L02?this.exportData(I02):G8l == L02 && (-A0l == I02.fileName.indexOf(H1l) && -A0l == I02.fileName.indexOf(S1l) && (I02.fileName=I02.fileName.concat(H1l)),this.exportData(I02));}else (S4l != (z02=I02.fileExt) && void B0l !== z02 || (e8l == L02?I02.fileExt=i1l:G8l == L02?I02.fileExt=R1l:c1l == L02 && (I02.fileExt=d1l)),P0l != Y02 && X0l != Y02 || (X0l == Y02 && N1l == typeof JSZip?w.BIEA && !w.BIEA10?o02=!B0l:this.importData(I02):Z02 || e8l != L02 && G8l != L02 && c1l != L02 || this.importData(I02)));return o02;},s._boolFormatter=function(s42,V42,l42,w42){return (A0l == w42?(M8l == l42?l42=A0l:M4l == l42 && (l42=B0l),l42=this._getBooleanValue(l42,B0l)):B0l == w42 && (l42 + S4l == M8l?l42=M8l:l42 + S4l == M4l && (l42=M4l)),l42);},s._checkCrossDomain=function(Q42){var f1l="https://";var T1l="localhost";var k1l="http://";var t42=!A0l,j42=T1l,U42=[],y42=V.location;return (Q42 && (B0l != Q42.toLowerCase().indexOf(k1l) && B0l != Q42.toLowerCase().indexOf(f1l) || (y42 && (j42=y42.protocol + o4l + y42.host),((U42=Q42.split(N7l))[B0l] + o4l + U42[P0l]).toLowerCase() != j42.toLowerCase() && (t42=!B0l))),t42);},s._encodeBase64=function(g42){var E42=S4l;return (void B0l !== g42 && (E42=btoa(encodeURIComponent(g42).replace(/%([0-9A-F]{2})/g,function(N42,a42){var h1l="0x";return String.fromCharCode(h1l + a42);}))),E42);},s._exportJson=function(m42,D42,K42,v42){var x1l="#BackColor";var K1l="FontUnderline";var u1l="FontStrike";var m1l="FontItalic";var q1l="#FontColor";var v1l="#Edit";var D1l="Edit";var r1l="FontBold";var f42={data:[]},H42=j4l,c42=B0l,h42=B0l,i42={},d42={},T42=S4l,S42=S4l,r42=A0l < this.DataRows,k42=[r1l,m1l,K1l,u1l],R42=B0l,u42=k42.length;for(H42=this.getFirstRow(j4l,C0l);H42;H42=this.getNextRow(H42))if(!H42 || C5l !== H42.id && L7l !== H42.Name && Y7l !== H42.Name){for((c42=B0l,h42=m42.length);c42 < h42;c42++){if((d42=m42[c42],!r42 || H42.UnitPos == d42.UnitPos)){if((S42=d42.Name,T42=D42?this._getCellText(H42,S42):this._getCellValue(H42,S42),d42.Name === v42 && A0l != T42))break;if((i42[S42]=T42,K42))for((this._getBooleanValue(H42[S42 + D1l],A0l) || (i42[S42 + v1l]=B0l),H42[S42 + p5l] && (i42[S42 + x1l]=H42[S42 + p5l]),H42[S42 + e5l] && (i42[S42 + q1l]=H42[S42 + e5l]),R42=B0l);R42 < u42;R42++)H42[S42 + k42[R42]] && (i42[S42 + C4l + k42[R42]]=A0l);}K42 && (this._getBooleanValue(H42.RowEdit,A0l) || (i42.Edit=B0l),H42.Background && (i42.BackColor=H42.Background),H42.Color && (i42.FontColor=H42.Color));}r42 && H42.UnitPos != this.DataRows - A0l || B0l < Object.keys(i42).length && (f42.data.push(i42),i42={});}return f42;},s._exportXml=function(J42,M42,G42){var O1l="<data>";var X1l="</row>";var M1l='<?xml version="1.0" encoding="UTF-8" ?>\r\n';var J1l="</data>";var A1l="<![CDATA[";var P1l="]]>";var B1l="<row>";var q42=[],x42=j4l,B42=B0l,X42=B0l,O42={},A42=S4l,P42=A0l < this.DataRows;for((q42.push(O1l),x42=this.getFirstRow(j4l,C0l));x42;x42=this.getNext(Rowr))if(!x42 || C5l !== x42.id && L7l !== x42.Name && Y7l !== x42.Name){for((P42 && B0l != x42.UnitPos || q42.push(B1l),B42=B0l,X42=J42.length);B42 < X42;B42++)if((O42=J42[B42],!P42 || x42.UnitPos == O42.UnitPos)){if((A42=M42?this._getCellText(x42,O42.Name):this._getCellValue(x42,O42.Name),O42.Name === G42 && A0l != A42))break;(q42.push(Z9l + O42.Name + z9l),_ibsUtil.isEmpty(A42) || q42.push(A1l + A42 + P1l),q42.push(W9l + O42.Name + z9l));}P42 && x42.UnitPos != this.DataRows - A0l || X1l != q42[q42.length - A0l] && q42.push(X1l);}return (q42.push(J1l),q42=M1l + q42.join(S4l));},s._finishDownload=function(b42){var b1l="; path=/";var G1l="fileDownloadToken=; expires=";var C42;(b42=b42 || e8l,Q.clearInterval(w.fileDownloadCheckTimer),w.fileDownloadCheckTimer=j4l,this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,b42,!B0l),(C42=new Date()).setDate(C42.getDate() - A0l),V.cookie=G1l + C42.toGMTString() + b1l);},s._getAlignByType=function(p42){var C1l="right";var p1l="left";return this._isBooleanType(p42)?p8l:this._isNumberType(p42)?C1l:p1l;},s._getBodyData=function(F42){var L1l="Align";var g82,Y42,I42,e42,o42,K82,a82,z42,j82,w82,f82,X82,N82=[],H82=[],l82=S4l,S82=S4l,W42=F42.from,L42=F42.cfg,d82=F42.sheetDesign,J82=F42.isTreeLevel,U82=F42.isDownRows,u82=F42.isDownRowVisible,y82=F42.rowHeights,i82=F42.downColNames,T82=F42.downColNamesLength,s82=F42.data,V82=F42.p,D82=F42.headerRows,h82=[],v82=[],x82=[],R82=B0l,Z42=[],r82=[],n42=B0l,q82=[],Q82=S4l;if(L42.downSum){if(this.Rows.FormulaRow)for((I42=this.Rows.FormulaRow,g82=B0l);g82 < this.DataRows && I42 && I42.Visible;g82++){if(!U82 || U82 && -A0l != L42.downRows.indexOf(n8l + this.getRowIndex(I42) + n8l) || u82 && I42.Visible){for((B0l == this.FormulaRowPosition && (D82++,h82.push(R82++)),H82.push(this._getExcelRowHeight(I42)),e8l == W42 && (a82=A0l,z42={},this._setRowProperty(z42,I42)),j82=[],Y42=B0l);Y42 < T82;Y42++)e1l != (e42=i82[Y42]) && (o42=void B0l === I42[e42]?S4l:this._getStringExcel(I42,e42,!A0l,L42,W42),S82=this._addCellColor(d82,I42,e42),G8l == W42 && (o42=(o42 + S4l).replace(/\r\n|\n|\r/g,S4l)),N1l !== o42 && void B0l !== o42 || (o42=S4l),j82.push(o42 + S82),e8l == W42 && (w82=Z5l + a82,l82=this.Cols[e42].Type,void B0l === this._getNumberValue(o42) && (l82=Q9l),this._setRowData(z42,w82,e42,o42,l82),z42[w82 + L5l]=I42[e42 + L5l],z42[w82 + Y5l]=I42[e42 + Y5l],z42[e42 + L5l]=I42[e42 + L5l],z42[e42 + Y5l]=I42[e42 + Y5l],a82++));(N82.push(j82.join(this.IB_DELIMITER_COL)),e8l == W42 && this.ExcelXF.push(z42));}I42=this.getNextRow(I42);}B0l < N82.length && B0l == this.FormulaRowPosition && (s82[V82++]=N82.join(this.IB_DELIMITER_ROW),s82[V82++]=this.IB_DELIMITER_ROW,y82=H82.concat(y82));}if((void B0l !== L42.ExcludeFooterRow && (L42.excludeFooterRow=L42.ExcludeFooterRow),!L42.excludeFooterRow))for(Z42=this.XF.firstChild;Z42;Z42=Z42.nextSibling)if(C5l != Z42.id && (!U82 || U82 && -A0l != L42.downRows.indexOf(n8l + this.getRowIndex(Z42) + n8l))){for((H82.push(this._getExcelRowHeight(Z42)),footerRowData=[],Y42=B0l);Y42 < T82;Y42++)if(e1l != (e42=i82[Y42])){if((n42=f82=this._getStringExcel(Z42,e42,!A0l,L42,W42),G8l == W42 && (f82=(f82 + S4l).replace(/\r\n|\n|\r/g,S4l)),e8l == W42)){(l82=Z42[e42 + I1l] || this.Cols[e42].Type,void B0l === this._getNumberValue(f82) && (l82=Q9l),n42+=A0l == d82 && S4l != (X82=this._addCellColor(d82,Z42,e42))?X82:this.IB_DELIMITER_COLOR,n42+=S4l != l82?l82=this.IB_DELIMITER_COLOR + l82:this.IB_DELIMITER_COLOR);var O82=Z42[e42 + L1l] || Z42.Def.Align || this.Cols[e42].Align;(n42+=N1l != O82?this.IB_DELIMITER_COLOR + O82:this.IB_DELIMITER_COLOR,void B0l !== Z42[e42 + L5l] && S4l == L42.downCols?n42+=this.IB_DELIMITER_COLOR + Z42[e42 + L5l]:n42+=this.IB_DELIMITER_COLOR);var B82=Z42[e42 + Y5l] || Z42.Def[e42 + Y5l] || this.Cols[e42].Span;void B0l !== B82 && S4l == L42.downCols?n42+=this.IB_DELIMITER_COLOR + B82:n42+=this.IB_DELIMITER_COLOR + A0l;var t82=Z42[e42 + J2l] || this.Cols[e42].LegacyFormat || this.Cols[e42].Format;if((p2l != l82 || t82 || (t82=this.Cols[e42].DateFormat || this.Cols[e42].DataFormat),void B0l !== t82 && S4l != t82)){if(B0l <= l82.indexOf(Y1l)){var c82=t82.split(v8l);A0l < c82.length && C4l == c82[A0l].charAt(B0l) && (c82[A0l]=M4l + c82[A0l].slice(A0l),t82=c82.join(v8l));}n42+=this.IB_DELIMITER_COLOR + t82;}else n42+=this.IB_DELIMITER_COLOR;}footerRowData.push(n42);}r82.push(footerRowData.join(this.IB_DELIMITER_COL));}var A82=B0l,M82=L42.downRows.split(n8l);for(I42=this.getFirstRow(j4l,C0l);I42;I42=this.getNextRow(I42))if((L42.downTreeHide || B0l == L42.downTreeHide && this._getTreeVisible(I42)) && (A82++,!U82 || U82 && -A0l < M82.indexOf(S4l + A82) || u82 && I42.Visible))for(var E82=B0l;E82 < this.DataRows;E82++)if(!(A0l == L42.excludeSubSum && I42.SubSumRow || P0l == L42.excludeSubSum && I42.CumulateRow || X0l == L42.excludeSubSum && (I42.SubSumRow || I42.CumulateRow))){for((e8l != W42 && M2l != W42 || y82.push(this._getExcelRowHeight(I42,E82)),e8l == W42 && (a82=A0l,z42={},this._setRowProperty(z42,I42,this.GetStatusValue(I42)),I42.SubSumRow?v82.push(R82++):I42.CumulateRow?x82.push(R82++):R82++),j82=[],Y42=B0l);Y42 < T82;Y42++)(o42=S4l,e1l != (e42=this.MultiRecord && this.MultiRecordShape?this._DownMultiMap[E82][Y42]:i82[Y42]) && (o42=this._getStringExcel(I42,e42,!B0l,L42,W42),S82=this._addCellColor(d82,I42,e42),I42.SubSumRow || I42.CumulateRow || (w.OnExportEncryption && (K82=w.OnExportEncryption(this,I42,e42,o42)),void B0l !== K82 && (o42=K82)),N1l !== o42 && void B0l !== o42 || (o42=S4l),j82.push(o42 + S82),e8l == W42 && (w82=Z5l + a82,this._setRowData(z42,w82,e42,o42,e42 && this.Cols[e42]?this.Cols[e42].Type:Q9l),j4l != I42[e42 + L5l] && (z42[w82 + L5l]=I42[e42 + L5l]),j4l != I42[e42 + Y5l] && (z42[w82 + Y5l]=I42[e42 + Y5l]),e42 && this.MultiRecord && this.MultiRecordShape && j4l != this.Cols[e42].RecordRowSpan && this._DownMultiMap[E82][Y42] && (z42[w82 + L5l]=this.Cols[e42].RecordRowSpan),e42 && this.MultiRecord && this.MultiRecordShape && j4l != this.Cols[e42].RecordColSpan && this._DownMultiMap[E82][Y42] && (z42[w82 + Y5l]=this.Cols[e42].RecordColSpan),a82++),J82 && this.MainCol == e42 && j82.push(I42.Level + S82)));(s82[V82++]=j82.join(this.IB_DELIMITER_COL),s82[V82++]=this.IB_DELIMITER_ROW,e8l == W42 && this.ExcelXB.push(z42));}if(e8l == W42 && L42.useFormula)for(Y42=B0l;Y42 < T82;Y42++)if((e42=i82[Y42],(Q82=this.Cols[e42].Formula) && Q8l == typeof Q82)){for(var k82,G82,P82,m82=this.LastCol();B0l <= m82;m82--)if((k82=this.GetColName(m82)) && -A0l < (P82=Q82.indexOf(k82)) && n8l !== Q82.charAt(P82 - A0l)){if((P82=i82.indexOf(k82)) < B0l){Q82=S4l;break;}(G82=this.Cols[k82].SaveName,Q82=Q82.replace(k82,n8l + G82 + n8l));}Q82 && q82.push({SaveName:this.Cols[e42].SaveName,Formula:Q82});}if(B0l < N82.length && L42.downSum && B0l != this.FormulaRowPosition)for((s82[V82++]=N82.join(this.IB_DELIMITER_ROW),s82[V82++]=this.IB_DELIMITER_ROW,y82=y82.concat(H82),g82=B0l);g82 < this.DataRows;g82++)h82.push(R82++);return (B0l < r82.length && (s82[V82++]=r82.join(this.IB_DELIMITER_ROW),s82[V82++]=this.IB_DELIMITER_ROW,y82=y82.concat(H82)),{p:V82,data:s82,headerRows:D82,rowHeights:y82,sumRow:h82,subSumRow:v82,cumulateRow:x82,formulas:q82});},s._getBooleanValue=function(b82,e82){var C82=e82,p82={1:A0l,true:A0l,0:B0l,false:B0l};return (this.BooleanSettingMode?C82=void B0l === b82?e82:b82 && M4l != b82?A0l:B0l:void B0l !== p82[b82=(b82 + S4l).toLowerCase()] && (C82=p82[b82]),C82);},s._getCCSStylesheetRuleStyle=function(n82,I82){var Z1l="cssRules";var o1l="rules";var z1l="initial";var o82,L82,F82,Z82,Y82,z82,W82=S4l;for((I82=I82.toLowerCase(),F82=V.all?o1l:Z1l,Z82=B0l);Z82 < V.styleSheets.length;Z82++){try{L82=V.styleSheets[Z82][F82];}catch(l52){continue;}if(L82)for(Y82=B0l;Y82 < L82.length;Y82++)if(L82[Y82] && L82[Y82].selectorText && -A0l != L82[Y82].selectorText.indexOf(n82) && L82[Y82].cssText && -A0l != L82[Y82].cssText.indexOf(I82)){for(o82=L82[Y82].style;-A0l != (z82=I82.indexOf(D8l));)I82=I82.substring(B0l,z82) + I82[z82 + A0l].toUpperCase() + I82.substring(z82 + P0l);o82[I82] && z1l != o82[I82] && (W82=o82[I82]);}}return W82;},s._getCellText=function(w52,s52){var F1l="FooterRow";var n1l="GroupSumType";var l3l="|| |";var V52=S4l,t52=this.GetOrgType(w52,s52),y52=w.get(w52,s52) + S4l;if(!w52 || !s52)return V52;if(W1l !== w52.Kind && U7l === this.MainCol && this.GroupTreeCols && F1l !== w52.id && C5l !== w52.id){if(this.GroupTreeCols[s52] && !w52.Def.Group)return S4l;if(w52.Def.Group && !this.GroupTreeCols[s52] && !this.getAttribute(w52,s52,n1l))return S4l;}if(W1l == w52.Kind)V52=s9l == this.Cols[s52].Type?this.getString(w52,s52):this._removeHTMLTag(this.getString(w52,s52));else if(b2l == t52 || b2l == this.Cols[s52].Type)V52=this._getPasswordType(w52,s52,y52);else if(this._isBooleanType(t52) || z2l === this.Cols[s52].Type)V52=this._getBooleanValue(y52,B0l);else if(IBSheet.__.isString(y52) && w9l == this.Cols[s52].Type){var Q52=y52.split(y52.charAt(B0l));V52=Q52.length?(S4l == Q52[A0l] || S4l != Q52[P0l] && j4l != Q52[P0l]?(S4l == Q52[P0l] || j4l == Q52[P0l] || Q52.length < X0l) && (Q52[P0l]=F8l):Q52[P0l]=Q52[A0l],Q52.join(y52.charAt(B0l))):l3l;}else (V52=w3l == this.Cols[s52].Type || Y1l == this.Cols[s52].Type?y52:S4l == y52?S4l:this.getString(w52,s52),C5l === w52.id && (B0l == y52 && void B0l !== this.SumZeroValue && (V52=this.SumZeroValue),Q9l == t52 && (V52=y52)),this.DataAutoTrim && Q8l == typeof V52 && b5l == w52.Kind && (V52=this._trim(V52)));return V52;},s._getCellValue=function(U52,E52){var j3l="AutoSum";var t3l="PopupEdit";var V3l="FormatFix";var E3l="CheckBox";var Q3l="(ALL)";var g3l="Radio";var U3l="AutoAvg";var H3l="ComboEdit";var y3l="Popup";var a3l="DummyCheck";this.Lang.Format;var a52=S4l,j52=S4l,g52=this.getAttribute(U52,E52,s3l) || this.getAttribute(U52,E52,I1l);if(this.getAttribute(U52,E52,V3l))return this._getCellText(U52,E52);switch((j52=this.getValue(U52,E52),O2l == U52.Kind && Q3l === (j52 + S4l).toUpperCase() && (j52=S4l),W1l == U52.Kind && s9l == this.Cols[E52].Type && (j52=this.getString(U52,E52)),g52)){case z5l:j52=this._getStatusTypeCellValue(g52,U52,E52,j52);break;case Q9l:case y3l:case t3l:j52=this._getTextTypeCellValue(g52,U52,E52,j52);break;case p2l:(a52=this.getAttribute(U52,E52,X2l) || this.getAttribute(U52,E52,J2l) || this.getAttribute(U52,E52,e2l) || this.getAttribute(U52,E52,g5l) || this.DateFormat || this.DataFormat,Q8l == typeof (j52=w.dateToString(this.getValue(U52,E52),a52)) && (j52=this._removeHTMLTag(j52)));break;case w3l:case Y1l:case j3l:case U3l:j52=this._getNumberTypeCellValue(g52,U52,E52,j52);break;case z2l:case E3l:case W5l:case g3l:case a3l:j52=this._getCheckBoxTypeCellValue(g52,U52,E52,j52);break;case N3l:case W2l:j52=this._getComboTypeCellValue(g52,U52,E52,j52);break;case H3l:j52=this._getComboEditTypeCellValue(g52,U52,E52,j52);}return (this.DataAutoTrim && Q8l == typeof j52 && b5l == U52.Kind && (j52=IBSheet._ibsUtil.trim(j52)),j52);},s._getCheckBoxTypeCellValue=function(R52,H52,S52,i52){var N52=i52;(this.getAttribute(H52,S52,W2l),this.getAttribute(H52,S52,S3l));return (N52=N52?N52 - B0l:B0l,B0l === this.GetCellValueMode && (N52=this._boolFormatter(H52,S52,N52,B0l)),N52);},s._getColInfo=function(P52,J52,M52){var R3l="30|";var h3l="Int|";var i3l="IBTreeLevelCol|";var k3l=/Format/i;var T3l="Text|";var d3l="[object Function]";var K52,u52,d52,c52,T52,x52=S4l,q52=S4l,O52=S4l,D52=S4l,v52=S4l,X52=S4l,f52=S4l,h52=S4l,r52=S4l,m52=S4l,B52=S4l,k52=S4l,G52=P52.hiddenColumn,b52=P52.numberTypeToText,C52=P52.allTypeToText,p52=J52.length,e52={Int:A0l,Float:A0l,AutoSum:A0l,AutoAvg:A0l},I52={Enum:A0l,Combo:A0l,ComboEdit:A0l},L52={left:A0l,center:A0l,right:A0l};for(K52=B0l;K52 < this.DataRows;K52++){for((d52=this.Cols,u52=B0l);u52 < p52;u52++){if((c52=this.MultiRecord && this.MultiRecordShape?this._DownMultiMap[K52][u52]:J52[u52],B0l == K52 && (x52+=(c52 && void B0l !== d52[c52].Name?d52[c52].Name:S4l) + n8l,q52+=this._getNumberValue(!c52 && this.MultiRecord && this.MultiRecordShape?this.MultiHeaderColSpan[this.MultiHeaderMap[K52][u52]][u52 - this._DownMultiMap[K52].indexOf(this.MultiHeaderMap[K52][u52]) - A0l] + d52[this.MultiHeaderMap[K52][u52]].WidthPad:B0l == d52[c52].Visible?B0l:d52[c52].Width,B0l) + n8l,O52+=(A0l == G52?d52[c52].Visible:M8l) + n8l,M52 && this.MainCol == c52 && (x52+=i3l,q52+=R3l,O52+=c3l)),D52+=(c52 && void B0l !== d52[c52].SaveName?d52[c52].SaveName:c52 && void B0l !== d52[c52].Name?d52[c52].Name:S4l) + n8l,k52=c52?d52[c52].LegacyType || d52[c52].Type:S4l,T52=c52?d52[c52].LegacyFormat || d52[c52].Format:S4l,p2l != k52 || T52 || (T52=d52[c52].DateFormat || this.DateFormat || d52[c52].DataFormat || this.DataFormat),Q8l != typeof T52 && (T52=(void B0l === T52 || d3l === Object.prototype.toString.call(T52) || p4l === Object.prototype.toString.call(T52) || y8l == typeof T52 || Object.prototype.toString.call(T52),S4l)),v52+=L52[X52=c52?(d52[c52].Align + S4l).toLowerCase():S4l]?X52 + n8l:this._getAlignByType(k52) + n8l,e52[k52]))if(b52)(f52+=T3l,h52+=n8l,r52+=n8l,m52+=n8l);else {(f52+=k52 + n8l,h52+=(T52 || S4l) + n8l);var A52=this._getDateFormatPattern(k52,T52);(r52+=(d52[c52].OrgFormat?d52[c52].OrgFormat:A52.replace(k3l,S4l)) + n8l,m52+=A52 + n8l);}else if(C52 && !I52[k52])(f52+=T3l,h52+=n8l,r52+=n8l,m52+=n8l);else {(f52+=(W2l == k52?N3l:k52) + n8l,h52+=p2l == k52?(T52 || S4l) + n8l:(T52?this.ConvertExcelFormat({type:k52,format:T52}):S4l) + n8l);A52=this._getDateFormatPattern(k52,T52);(r52+=(c52 && d52[c52].OrgFormat?d52[c52].OrgFormat:A52.replace(k3l,S4l)) + n8l,m52+=A52 + n8l);}(M52 && this.MainCol == c52 && (D52+=i3l,v52+=f3l,f52+=h3l,h52+=n8l,r52+=n8l,m52+=n8l),B52+=n8l + (d52[c52] && d52[c52].DataFormat?d52[c52].DataFormat:S4l));}(B52=B52.substring(A0l),D52=D52.substring(B0l,D52.length - A0l),v52=v52.substring(B0l,v52.length - A0l),f52=f52.substring(B0l,f52.length - A0l),h52=h52.substring(B0l,h52.length - A0l),r52=r52.substring(B0l,r52.length - A0l),m52=m52.substring(B0l,m52.length - A0l),A0l < this.DataRows && K52 < this.DataRows - A0l && (D52+=e4l,v52+=e4l,f52+=e4l,h52+=e4l,r52+=e4l,m52+=e4l,B52+=e4l));}return {name:x52=x52.substring(B0l,x52.length - A0l),width:q52=q52.substring(B0l,q52.length - A0l),visible:O52=O52.substring(B0l,O52.length - A0l),saveName:D52,align:v52,type:f52,format:h52,orgFormat:r52,datePattern:m52,dataFormat:B52};},s._getComboEditTypeCellValue=function(V72,W52,w72,s72){var Z52=this.getAttribute(W52,w72,S3l),Y52=this.getAttribute(W52,w72,W2l),F52=[],z52=[],o52=B0l,n52=B0l,l72=s72;if((Z52=Z52 && (S4l + Z52).substring(A0l),Y52=Y52 && (S4l + Y52).substring(A0l),W1l != W52.Kind && Y52))for((z52=Y52.split(n8l),F52=Z52.split(n8l),n52=z52.length,o52=B0l);o52 < n52;o52++)if(s72 == z52[o52]){l72=F52[o52];break;}return l72;},s._getComboTypeCellValue=function(H72,a72,N72,j72){var Q72=this.getAttribute(a72,N72,S3l),U72=B0l,y72=B0l,E72=B0l,g72=[],t72=j72;if((Q72=Q72 && (S4l + Q72).substring(A0l),W1l != a72.Kind)){if(Q72)for((E72=(g72=Q72.split(n8l)).length,y72=B0l);y72 < E72;y72++)if(j72 == g72[y72]){(U72=A0l,t72=j72);break;}U72 || (t72=S4l);}return t72;},s._getCookie=function(c72){var S72=B0l,i72=B0l,R72=B0l;c72+=g7l;try{for(;S72 <= V.cookie.length;){if((i72=S72 + c72.length,V.cookie.substring(S72,i72) == c72))return (-A0l == (R72=V.cookie.indexOf(u6l,i72)) && (R72=V.cookie.length),unescape(V.cookie.substring(i72,R72)));if(B0l == (S72=V.cookie.indexOf(F8l,S72) + A0l))break;}}catch(d72){}return S4l;},s._getDateFormat=function(k72){var r3l="yyyy/MM/dd";var q3l="yyyy/MM/dd HH:mm:ss";var X3l="HH:mm";var u3l="yyyy/MM";var v3l="MM/dd";var B3l="yyyy/MM/dd HH:mm";var T72=r3l;return (k72 && (m3l == k72?T72=r3l:K3l == k72?T72=u3l:D3l == k72?T72=v3l:x3l == k72?T72=q3l:O3l == k72?T72=B3l:A3l == k72?T72=Z2l:P3l == k72 && (T72=X3l)),T72);},s._getDateFormatPattern=function(r72,f72){var j0C=/^M.*y.*d.*H.*m$/i;var b3l=/^M.*y.*d$/;var M3l=/^y.*M.*d$/;var J3l="Ymd";var C3l=/^M.*d.*y$/;var y0C=/^y.*M.*d.*H.*m$/i;var N0C=/^H.*m.*s$/i;var l0C=/^M.*y.*d.*H.*m.*s$/i;var a0C="Hms";var I3l="Ym";var Q0C="YmdHm";var g0C=/^d.*y.*M.*H.*m$/i;var G3l=/^y.*d.*M$/;var S0C=/^H.*m$/i;var W3l="YmdHms";var V0C=/^d.*y.*M.*H.*m.*s$/i;var E0C=/^d.*M.*y.*H.*m$/i;var F3l=/^y.*M.*d.*H.*m.*s$/i;var e3l=/^d.*y.*M$/;var o3l="Md";var t0C=/^y.*d.*M.*H.*m$/i;var s0C=/^d.*M.*y.*H.*m.*s$/i;var w0C=/^M.*d.*y.*H.*m.*s$/i;var Y3l=/^M.*y$/;var p3l=/^d.*M.*y$/;var U0C=/^M.*d.*y.*H.*m$/i;var n3l=/^y.*d.*M.*H.*m.*s$/i;var L3l=/^y.*M$/;var H0C="Hm";var Z3l=/^M.*d$/;var z3l=/^d.*M$/;var h72=S4l;return (p2l !== r72 || f72 || (f72=J3l),r72 && f72 && (J3l == f72 || B0l <= f72.search(M3l) || B0l <= f72.search(G3l) || B0l <= f72.search(b3l) || B0l <= f72.search(C3l) || B0l <= f72.search(p3l) || B0l <= f72.search(e3l)?h72=m3l:I3l == f72 || B0l <= f72.search(L3l) || B0l <= f72.search(Y3l)?h72=K3l:o3l == f72 || B0l <= f72.search(Z3l) || B0l <= f72.search(z3l)?h72=D3l:W3l == f72 || B0l <= f72.search(F3l) || B0l <= f72.search(n3l) || B0l <= f72.search(l0C) || B0l <= f72.search(w0C) || B0l <= f72.search(s0C) || B0l <= f72.search(V0C)?h72=x3l:Q0C == f72 || B0l <= f72.search(y0C) || B0l <= f72.search(t0C) || B0l <= f72.search(j0C) || B0l <= f72.search(U0C) || B0l <= f72.search(E0C) || B0l <= f72.search(g0C)?h72=O3l:a0C == f72 || B0l <= f72.search(N0C)?h72=A3l:(H0C == f72 || B0l <= f72.search(S0C)) && (h72=P3l)),h72);},s._getDefault=function(m72,K72,u72){if(void B0l === m72 || j4l == m72)return K72;switch(u72 || typeof K72){case y8l:return this._getNumberValue(m72,K72);case V5l:return this._getNumberValue(m72,K72,A0l);case Q8l:return B0l == m72.length?K72:m72 + S4l;case j8l:return this._getBooleanValue(m72,K72);default:return K72;}},s._getDownColNames=function(v72){var i0C="Visible";var x72,B72,D72,J72,M72,q72=[],O72=[],A72=[],P72=[],X72=[];if(S4l != v72.downCols)for((x72=B0l,B72=(q72=i0C === v72.downCols?this.getCols(i0C):v72.downCols.split(n8l)).length);x72 < B72;x72++){if(!this.Cols[q72[x72]])return [];this.GetColName(q72[x72]) && O72.push(this.GetColName(q72[x72]));}else for(D72=this.GetFirstColA();D72;D72=this.GetNextColA(D72))U7l !== D72 && R0C !== D72 && this.Cols[D72].CanExport && O72.push(D72);for((q72=[],v72.objReturn && (P72=[],X72=[]),-A0l == v72.mode?A72={Status:A0l,DelCheck:A0l,Result:A0l}:A0l == v72.mode && (A72={Status:A0l,DelCheck:A0l}),x72=B0l,B72=O72.length);x72 < B72;x72++)(D72=O72[x72]) && (J72=this.Cols[D72].LegacyType || this.Cols[D72].Type,M72=this.Cols[D72].Hidden,A72[J72] || (-A0l == v72.mode || P0l == v72.mode) && M72 || (v72.objReturn?(P72[D72]=this.Cols[D72],X72.push(D72)):q72.push(D72)));return (v72.objReturn && (q72[B0l]=P72,q72[A0l]=X72),q72);},s._getHeaderData=function(p72){var h0C="\0";var T0C="HtmlPostfix";var d0C="HtmlPrefix";var k0C="(*)";var r0C="TreeLevel";var c0C="Required";var Z72,Y72,l22,b72,G72,t22,z72,e72,w22,s22,I72,W72,L72,o72=p72.from,j22=p72.cfg,U22=p72.sheetDesign,E22=p72.isTreeLevel,g22=(p72.isDownRows,p72.isDownRowVisible,p72.rowHeights),a22=p72.downColNames,N22=p72.downColNamesLength,V22=p72.data,F72=p72.p,Q22=p72.headerRows,H22=p72.isHeaderMerge,y22=this.Style + c0C;for((Z72=B0l,l22=this.XH.childNodes.length);Z72 < l22;Z72++)if(W1l == (b72=GetNode(this.XH,Z72)).Kind && b72.Visible)for(var C72=B0l;C72 < this.DataRows;C72++){for((Q22++,e8l != o72 && M2l != o72 || g22.push(this._getExcelRowHeight(b72,C72)),e8l == o72 && (s22=A0l,I72={},this._setRowProperty(I72,b72)),W72=[],Y72=B0l);Y72 < N22;Y72++)if(e1l != (G72=this.MultiRecord && this.MultiRecordShape?this.MultiHeaderMap[C72][Y72]:a22[Y72])){if((z72=S4l,j22.RequiredMark && (t22=this.Cols,G72 && A0l == t22[G72].Required)))if(H22)(B0l <= (b72[G72 + d0C] + S4l || S4l).indexOf(y22) || B0l <= (b72[G72 + T0C] + S4l || S4l).indexOf(y22)) && (z72=k0C);else {var n72=A0l;(this.Rows.Filter && (n72+=A0l),this.Rows.FormulaRow && B0l == this.GetAutoSumPosition() && (n72+=A0l),Z72 == l22 - n72 && (z72=k0C));}(e72=S4l,G72 && s9l == this.Cols[G72].Type?e72+=this._getCellValue(b72,G72):e72=b72[G72 + f0C]?b72[G72 + f0C]:this._getCellText(b72,G72),G72 && this.MultiRecord && this.MultiRecordShape && this.MultiHColSpan && this.MultiHColSpan && y8l == typeof this.MultiHColSpanValue[B0l][G72] && B0l < this.MultiHColSpanValue[C72][G72] && (e72=this.MultiHColSpanTitle[C72][G72]),G8l == o72 && (e72=(e72 + S4l).replace(/\r\n|\n|\r/g,S4l)),w22=this._addCellColor(U22,b72,G72),N1l != (e72=e72 && (e72 + S4l).replace(h0C,S4l)) && j4l != e72 || (e72=S4l),W72.push(e72 + z72 + w22),e8l == o72 && (L72=Z5l + s22,this.ExcelColsMap[G72]=L72,this._setRowData(I72,L72,G72,e72,this.Cols[G72].Type),j4l != b72[G72 + L5l] && (I72[L72 + L5l]=b72[G72 + L5l]),j4l != b72[G72 + Y5l] && (I72[L72 + Y5l]=b72[G72 + Y5l]),G72 && this.MultiRecord && this.MultiRecordShape && (this.MultiHColSpan && y8l == typeof this.MultiHColSpanValue[B0l][G72]?B0l < this.MultiHColSpanValue[C72][G72]?(I72[L72 + Y5l]=this.MultiHColSpanValue[C72][G72],I72[L72]=this.MultiHColSpanTitle[C72][G72]):B0l === this.MultiHColSpanValue[C72][G72] && B0l < this.Cols[G72].RecordRowSpan?I72[L72 + L5l]=this.Cols[G72].RecordRowSpan - C72:this.MultiHColSpanValue[C72][G72] < B0l && (I72[L72 + Y5l]=B0l):(j4l != this.Cols[G72].RecordRowSpan && this._DownMultiMap[C72][Y72] && (I72[L72 + L5l]=this.Cols[G72].RecordRowSpan),j4l != this.Cols[G72].RecordColSpan && this._DownMultiMap[C72][Y72] && (I72[L72 + Y5l]=this.Cols[G72].RecordColSpan))),s22++),E22 && this.MainCol == G72 && W72.push(r0C + w22));}(V22[F72++]=W72.join(this.IB_DELIMITER_COL),V22[F72++]=this.IB_DELIMITER_ROW,e8l == o72 && this.ExcelXH.push(I72));}return {p:F72,headerRows:Q22};},s._getHeaderText=function(T22){var k22,h22,c22,d22,S22=S4l,r22=T22.length,f22=[];if(this.MultiRecord && this.MultiRecordShape)for(var R22=B0l;R22 < this.DataRows;R22++)for(var i22=B0l;i22 < this.MultiHeaderMap[B0l].length;i22++)f22.push(this.MultiHeaderMap[R22][i22]);for((R22=B0l,k22=this.XH.childNodes.length);R22 < k22;R22++)if(W1l == (c22=GetNode(this.XH,R22)).Kind){for((i22=B0l,h22=r22);i22 < h22;i22++)T22[i22]?(d22=this.Cols[T22[i22]].Name,s9l == this.Cols[d22].Type?S22+=this._getCellValue(c22,d22) + n8l:c22[d22 + f0C]?S22+=c22[d22 + f0C] + n8l:S22+=this._getCellText(c22,d22) + n8l):S22+=this._getCellText(c22,f22[i22]) + n8l;(S22=S22.substring(B0l,S22.length - A0l),R22 < k22 - A0l && (S22+=e4l));}return S22;},s._getNumberTypeCellValue=function(u22,D22,v22,m22){var K22=parseFloat(m22);return (isNaN(K22) && (K22=m22 - B0l + S4l == m22?m22 - B0l:m22),K22);},s._getNumberValue=function(x22,O22,P22,B22,A22){var q22=O22;return (void B0l === x22 || isNaN(x22) || (q22=x22=P22?parseFloat(x22):parseInt(x22,p0l),isNaN(x22)?q22=O22:(void B0l !== B22 && x22 < B22 && (q22=O22),void B0l !== A22 && A22 < x22 && (q22=O22))),q22);},s._getPasswordType=function(G22,b22,C22){var m0C="StaticPassword";var K0C="Password";var X22=S4l,J22=B0l,M22=B0l;if(B0l == this.getAttribute(G22,b22,m0C))for((J22=B0l,M22=C22.length);J22 < M22;J22++)X22+=X8l;else X22=this.getMessage(K0C);return X22;},s._getStatusTypeCellValue=function(I22,L22,Y22,e22){var u0C="R";var p22=e22;return (({I:A0l,U:A0l,D:A0l})[e22] || (p22=u0C),p22);},s._getTextTypeCellValue=function(z22,o22,Z22,W22){this.getAttribute(o22,Z22,X2l) || this.getAttribute(o22,Z22,J2l);return this.getString(o22,Z22) + S4l;},s._getTitleConfig=function(S92){var D0C="0|";var N92,l92=S92,U92=S4l,E92=S4l,a92=S4l,g92=S4l,F22={},w92=S4l,s92=S4l,V92=S4l,Q92=S4l,y92=S4l,t92=S4l,j92=S4l,n22=B0l,H92={left:A0l,center:A0l,right:A0l};for((n22=B0l,N92=l92.length);n22 < N92;n22++)(void B0l === l92[n22].text && (l92[n22].text=S4l),void B0l === l92[n22].Text && (l92[n22].Text=S4l),U92+=(l92[n22].text || l92[n22].Text) + this.IB_DELIMITER_TITLE_BACKSLASH,E92+=H92[a92=((l92[n22].align || l92[n22].Align) + S4l).toLowerCase()]?a92 + n8l:f3l,g92+=this._getNumberValue(l92[n22].height || l92[n22].Height,B0l) + n8l,(F22=l92[n22].style || l92[n22].Style) && I4l == typeof F22?(w92+=this._getBooleanValue(F22.fontBold || F22.FontBold,B0l) + n8l,void B0l === F22.fontName && (F22.fontName=S4l),void B0l === F22.FontName && (F22.FontName=S4l),V92+=(F22.fontName || F22.FontName) + n8l,Q92+=this._getNumberValue(F22.fontSize || F22.FontSize,B0l) + n8l,y92+=this._getBooleanValue(F22.fontUnderline || F22.FontUnderline,B0l) + n8l,s92+=w._ibsUtil.getWebColor(F22.fontColor || F22.FontColor,A0l) + n8l,t92+=w._ibsUtil.getWebColor(F22.backColor || F22.BackColor,A0l) + n8l,j92+=this._getBooleanValue(F22.border || F22.Border,A0l) + n8l):(w92+=D0C,V92+=n8l,Q92+=D0C,y92+=D0C,s92+=n8l,t92+=n8l,j92+=c3l));return {text:U92=U92.substring(B0l,U92.length - A0l),align:E92=E92.substring(B0l,E92.length - A0l),height:g92=g92.substring(B0l,g92.length - A0l),fontBold:w92=w92.substring(B0l,w92.length - A0l),fontColor:s92=s92.substring(B0l,s92.length - A0l),fontName:V92=V92.substring(B0l,V92.length - A0l),fontSize:Q92=Q92.substring(B0l,Q92.length - A0l),fontUnderline:y92=y92.substring(B0l,y92.length - A0l),backColor:t92=t92.substring(B0l,t92.length - A0l),border:j92=j92.substring(B0l,j92.length - A0l)};},s._getTreeVisible=function(i92){var R92;return !this.MainCol || B0l == i92.Level || ! !i92.parentNode && B0l != (R92=i92.parentNode).Expanded && B0l != R92.Visible && this._getTreeVisible(i92.parentNode);},s._isBooleanType=function(c92){return ! !({CheckBox:A0l,DelCheck:A0l,DummyCheck:A0l,Radio:A0l})[c92];},s._isNumberType=function(d92){return ! !({Int:A0l,Float:A0l,AutoSum:A0l,AutoAvg:A0l})[d92];},s._makeColumnTag=function(T92,k92){return this.MarkupTagSS + T92 + this.MarkupTagSE + k92 + this.MarkupTagES + T92 + this.MarkupTagEE;},s._makeLoadForm=function(q92,C92,O92,B92,A92,G92){var e0C="CrossDomain";var F0C='<iframe name="';var b0C="-9999";var q0C="IBSheetLoadExcelForm";var p0C="columnTag";var l4C='">';var G0C="absolute";var o0C=", ";var X0C="IBSheetLoadTextForm";var w4C="100";var I0C="FileExt";var L0C="LoadExcelSheetID";var s4C="50";var P0C="LoadText.jsp";var C0C="submit";var n0C='" id="';var Y0C="file";var m92=S4l,r92=S4l,K92=S4l,f92=j4l,h92=j4l,u92=this,D92=S4l,v92=S4l,P92=j4l,X92=w.BIEA && !w.BIEA11,J92=S4l;if((A92=this._getNumberValue(A92,B0l,A0l),this.Source.LoadExcel && this.Source.LoadText)){if((e8l == q92 || c1l == q92?(v92=A0l == w.g_isDirectLoadExcel?(D92=v0C,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,B5l),this.Source.DirectLoadExcel.Url):(D92=x0C,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,A5l),this.Source.LoadExcel.Url),m92=q0C,r92=O0C,K92=B0C):G8l == q92 && (w.g_targetTextSheetID=this.id,D92=A0C,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,P0C),v92=this.Source.LoadText.Url,m92=X0C,r92=J0C,K92=M0C),this._removeForm(m92),J92=v92,J92+=(B0l <= v92.indexOf(d9l)?T9l:d9l) + k9l + D92,(f92=V.createElement(N9l)).method=H9l,f92.name=m92,f92.id=m92,f92.encoding=S9l,f92.enctype=S9l,f92.target=r92,f92.action=J92,w.BChrome || w.BSafariMac || w.BSafariWin || w.BSafari || w.BOpera || w.BOpera8?(f92.style.position=G0C,f92.style.left=r9l,f92.style.top=r9l,f92.style.width=r9l,f92.style.height=r9l,f92.style.zIndex=b0C):f92.style.display=K9l,(h92=V.createElement(i9l)).type=C0C,f92.appendChild(h92),(h92=V.createElement(i9l)).type=R9l,h92.name=p0C,X92 && !G92 && (B92+=this._makeColumnTag(e0C,M8l),B92+=this._makeColumnTag(I0C,O92),B92+=this._makeColumnTag(L0C,w.g_LoadExcelSheetID.join(e4l))),h92.value=B92,f92.appendChild(h92),!X92 && !G92)){if(((h92=V.createElement(i9l)).type=Y0C,h92.name=Y0C,h92.id=K92,h92.title=K92,P92=h92,O92)){for(var b92=(O92 + S4l).split(n8l),M92=S4l,x92=B0l;x92 < b92.length;x92++)(B0l < x92 && (M92+=o0C),M92+=v8l + b92[x92].replace(v8l,S4l));h92.accept=M92;}(h92.onchange=function(I92){var Z0C="ExceedFileSize";var z0C="MB";var w4l=1024;var e92=I92.target.files[B0l].size,p92=w4l * A92 * w4l;if(S4l != this.value)return B0l < p92 && p92 < e92?(u92.hideMessage(),void u92.ShowAlert(u92.getMessage(Z0C,G5l).replace(/%d/g,A92 + z0C),W0C)):void u92._selectFileAction(f92,q92,C92,O92,this.value);},f92.appendChild(h92));}((h92=w.BIEA && !w.BIEA9?V.createElement(F0C + r92 + n0C + r92 + l4C):V.createElement(h9l)).name=r92,h92.id=r92,h92.title=r92,h92.width=w4C,h92.height=s4C,f92.appendChild(h92),V.body.appendChild(f92),f92.style.visibility=R9l,Q.frames[r92].name=r92,X92 || G92?f92.submit():(P92.focus(),P92.click()));}},s._prepareExportSetting=function(){var t4C="";var E4C="";var g4C="";var Q4C=".jsp";var U4C="";var y4C="";var W92=S4l;this.Source.Export && Q8l == typeof this.Source.Export.Url?((W92=this.Source.Export.Url.split(N7l))[W92.length - A0l]=S4l,W92=W92.join(N7l)):this.Export && Q8l == typeof this.Export.Url && ((W92=this.Export.Url.split(N7l))[W92.length - A0l]=S4l,W92=W92.join(N7l));for(var z92=[j9l,x0C,U9l,A0C,g9l,V4C,t9l,v0C],o92=B0l;o92 < z92.length;o92++)(this.Source[z92[o92]] || (this.Source[z92[o92]]={}),this.Source.Export[z92[o92] + N6l]?this.Source[z92[o92]].Url=this.Source.Export[z92[o92] + N6l]:this.Source[z92[o92]].Url?this.Source[z92[o92]].Url=this.Source[z92[o92]].Url:this.Source[z92[o92]].Url=S4l == W92?z92[o92] + Q4C:W92 + z92[o92] + Q4C);if((this.ImageList=[],this.Down2ExcelBufferInfo={},this._eventFunctions={},this.MarkupTagDelimiter?(this.MarkupTagSS=this.MarkupTagDelimiter[B0l],this.MarkupTagSE=this.MarkupTagDelimiter[A0l],this.MarkupTagES=this.MarkupTagDelimiter[P0l],this.MarkupTagEE=this.MarkupTagDelimiter[X0l]):(this.MarkupTagSS=Z9l,this.MarkupTagSE=z9l,this.MarkupTagES=W9l,this.MarkupTagEE=z9l),this.IB_DELIMITER_ROW=y4C,this.IB_DELIMITER_COL=t4C,this.IB_DELIMITER_SHEET=j4C,this.IB_DELIMITER_END=U4C,this.IB_DELIMITER_TITLE_NEWLINE=U4C,this.IB_DELIMITER_TITLE_BACKSLASH=t4C,this.IB_DELIMITER_COLOR=E4C,this.IB_DELIMITER_TREE_INDENT=g4C,this.DataRows=this.MultiRecord && this.MultiRecordShape?this.MultiRecordMax:A0l,this.SearchSync=B0l,this.MultiRecord && this.MultiRecordShape)){this._DownMultiMap=[];for(var Y92=B0l;Y92 < this.DataRows;Y92++){this._DownMultiMap.push([]);for(var L92=B0l;L92 < this.MultiHeaderMap[B0l].length;L92++)this._DownMultiMap[Y92][L92]=this.MultiHeaderMap[Y92][L92];}for(Y92=B0l;Y92 < this.DataRows;Y92++)for(L92=B0l;L92 < this.MultiHeaderMap[B0l].length;L92++)if(this._DownMultiMap[Y92][L92] && A0l < this.Cols[this._DownMultiMap[Y92][L92]].RecordColSpan && A0l < this.Cols[this._DownMultiMap[Y92][L92]].RecordRowSpan)for(var Z92=B0l;Z92 < this.Cols[this._DownMultiMap[Y92][L92]].RecordRowSpan;Z92++){for(var F92=A0l;F92 < this.Cols[this._DownMultiMap[Y92][L92]].RecordColSpan;F92++)this._DownMultiMap[Y92 + Z92][L92 + F92]=void B0l;B0l < Z92 && (this._DownMultiMap[Y92 + Z92][L92]=void B0l);}else if(this._DownMultiMap[Y92][L92] && A0l < this.Cols[this._DownMultiMap[Y92][L92]].RecordColSpan){for(Z92=A0l;Z92 < this.Cols[this._DownMultiMap[Y92][L92]].RecordColSpan;Z92++)this._DownMultiMap[Y92][L92 + Z92]=void B0l;L92+=this.Cols[this._DownMultiMap[Y92][L92]].RecordColSpan - A0l;}else if(this._DownMultiMap[Y92][L92] && A0l < this.Cols[this._DownMultiMap[Y92][L92]].RecordRowSpan)for(Z92=A0l;Z92 < this.Cols[this._DownMultiMap[Y92][L92]].RecordRowSpan;Z92++)this._DownMultiMap[Y92 + Z92][L92]=void B0l;}},s._removeForm=function(l62){var n92=V.getElementById(l62);n92 && (n92.innerHTML=j4l,V.body.removeChild(n92),n92=j4l);},s._removeHTMLTag=function(w62,s62){if(j4l == w62 || Q8l != typeof w62)return S4l;switch(s62){case A0l:return w62.replace(/<([^>]*)>/gi,S4l);case P0l:return w62.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,S4l);default:return w62.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,S4l);}},s._selectFileAction=function(N62,y62,S62,H62,V62){var E62=S4l,t62=S4l,j62=S4l,U62=B0l,g62=B0l,a62=[],Q62={};V62=V62;if((e8l == y62?(Q62={".xls":A0l,".xlsx":A0l},t62=O0C,j62=a4C):G8l == y62?(Q62={".":A0l,".txt":A0l,".csv":A0l},t62=J0C,j62=N4C,V62.indexOf(v8l) < B0l && (V62+=v8l)):c1l == y62 && (Q62={".":A0l,".txt":A0l,".csv":A0l,".xls":A0l,".xlsx":A0l},t62=O0C,j62=N4C,V62.indexOf(v8l) < B0l && (V62+=v8l)),S4l != H62))for((Q62={},U62=B0l,g62=(a62=H62.split(n8l)).length);U62 < g62;U62++)Q62[v8l + a62[U62]]=A0l;S4l != V62 && (-A0l < V62.indexOf(v8l) && Q62[E62=V62.substring(V62.lastIndexOf(v8l),V62.length).toLowerCase()]?(G8l != y62 && c1l != y62 || v8l != E62 || (V62=V62.substring(B0l,V62.lastIndexOf(v8l))),N62.target=t62,N62.submit(),w.OnLoadFileSelect && w.OnLoadFileSelect(this,y62,V62)):this.ShowAlert(this.getMessage(j62,G5l),W0C));},s._setRowData=function(i62,R62,c62,d62,T62){(i62[R62]=d62,i62[R62 + I1l]=T62,i62[R62 + o5l]=c62);},s._setRowProperty=function(k62,f62,h62){(k62.Kind=f62.Kind,k62.id=f62.id,k62.UnitPos=f62.UnitPos,k62.SubSumRow=f62.SubSumRow,k62.CumulateRow=f62.CumulateRow,k62.RowMerge=f62.RowMerge,k62.Status=h62);},s._trim=function(r62){return r62=(r62+=S4l).replace(X4l,S4l).replace(J4l,S4l);},s._validInputRow=function(m62,v62){var S4C="F";var H4C="D";var i4C="S";var R4C="P";var K62,u62=-A0l,D62=B0l,O62=B0l,x62={},B62={NoDataRow:A0l,GroupRow:A0l,CountRow:A0l,FillRow:A0l,ToolBar:A0l},q62=B0l;if(v62)for((D62=B0l,O62=(v62=v62.split(n8l)).length);D62 < O62;D62++)switch(v62[D62]){case I2l:x62.Header=A0l;break;case H4C:x62.Data=A0l;break;case S4C:B62.Filter=A0l;break;case i4C:break;case R4C:q62=A0l;}return (j4l != m62 && I4l == typeof m62 && void B0l !== m62.Kind?K62=m62:(m62=this._getNumberValue(m62),isNaN(m62) || (K62=this.getRowByIndex(m62))),K62 && (x62[(u62=K62).Kind] && (u62=-A0l),B62[K62.id] && (u62=-A0l),q62 && C5l === K62.id && (u62=-A0l),q62 && (K62.SubSumRow || K62.CumulateRow) && (u62=-A0l)),u62);},s.ExportData=function(A62){var d4C="xml";var T4C="json";var G62,p62,e62,I62,b62,L62,P62=[],J62=B0l,X62=S4l,C62=S4l,M62=B0l;if(j4l == A62 || void B0l === A62)return this.InvalidValue;for((G62=(A62.type || A62.Type || S4l).toLowerCase(),e62=A62.colDelim || A62.ColDelim || b4l,I62=A62.rowDelim || A62.RowDelim || W8l,M62=void B0l === A62.mode || void B0l === A62.Mode?B0l:j4l,M62=this._getNumberValue(M62,B0l),A62.Cols=A62.Cols || A62.cols,A62.Cols=void B0l === A62.Cols?[]:(A62.Cols + S4l).split(n8l),b62=this._getBooleanValue(A62.FormattedText,B0l),L62=this._getBooleanValue(A62.StyleProperty,B0l),J62=B0l,p62=A62.Cols.length);J62 < p62;J62++)(c4C == G62 && A0l === M62 && S4l === A62.Cols[J62] && P62.push({}),-A0l !== (C62=this.Cols[A62.Cols[J62]]) && P62.push({Name:C62.Name}));if(B0l === P62.length)for(X62 in this.Cols)e1l != X62 && R0C != X62 && (B2l == X62 && A0l != this.Cols[X62].Visible || P62.push({Name:X62}));return d4C == G62?this._exportXml(P62,b62,A62.checkCol):T4C == G62?this._exportJson(P62,b62,L62,A62.checkCol):c4C == G62?this._exportCsv(P62,b62,e62,I62,M62,A62.newLine || A62.NewLine,A62.checkCol):this.InvalidValue;},s.GetAutoSumPosition=function(){return this.FormulaRowPosition;},s.GetColIndexInfo=function(){var o62=S4l,Z62=B0l,Y62=B0l,W62=this.ColNames.length,z62=B0l;for((this.ColIndexInfo=[],Z62=B0l);Z62 < W62;Z62++)for((Y62=B0l,z62=(o62=this.ColNames[Z62]).length);Y62 < z62;Y62++)e1l !== o62[Y62] && U7l !== o62[Y62] && this.ColIndexInfo.push(o62[Y62]);},s.GetColName=function(F62){return F62 - B0l == F62?(void B0l !== this.ColIndexInfo && B0l !== this.ColIndexInfo.length || this.GetColIndexInfo(),this.ColIndexInfo[F62]?this.ColIndexInfo[F62]:S4l):this.Cols[F62]?F62:this.SaveNameInfo[F62]?this.SaveNameInfo[F62].ColName:S4l;},s.GetDataRowHeight=function(){return this.RowHeight?this.RowHeight:this.MinRowHeight;},s.GetExcelRowHeight=function(t12,y12){var n62=this._validInputRow(t12),w12=B0l;if(-A0l === n62)return this.InvalidValue;if(!n62.Visible)return w12;if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict && n62.r1){var s12;if(this.MultiRecord && this.MultiRecordShape && n62.r1)for(var V12=n62.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,l12=B0l;V12;){if(l12 == y12)return V12.offsetHeight;(V12=V12.nextSibling,l12++);}for(l12=B0l;l12 < n62.r1.childNodes.length;l12++){var Q12=n62.r1.childNodes[l12].offsetHeight;(s12=s12 || Q12,B0l < Q12 && Q12 < s12 && (s12=Q12));}w12=s12 || this.MinRowHeight;}else w12=(w12=this.GetRHeight(n62,y12)) || this.MinRowHeight;return w12;},s.GetFirstColA=function(j12){var N12,U12=this.ColNames;N12=j4l == j12?(j12=B0l,U12.length):B0l == j12?A0l:A0l == j12?U12.length - A0l:(j12=U12.length - A0l,U12.length);for(var a12=j12;a12 < N12;a12++){for(var E12=B0l,g12=U12[a12];g12[E12] && e1l == g12[E12];E12++);if(g12[E12])return g12[E12];}return j4l;},s.GetHeaderBackColor=function(){var H12=S4l,S12=j4l,R12=j4l,c12=j4l,i12=B0l;for(i12=B0l;i12 < this.XH.childNodes.length;i12++)if(W1l == (S12=GetNode(this.XH,i12)).Kind){S12.Background?H12=S12.Background:(R12=this.getCell(S12,this.getFirstCol())) && (c12=GetStyle(R12),H12=IBSheet._ibsUtil.getWebColor(c12.backgroundColor));break;}return (-A0l === H12 && (H12=this.InvalidValue),H12);},s.GetHeaderFontColor=function(){var d12=S4l,T12=j4l,f12=j4l,h12=j4l,k12=B0l;for(k12=B0l;k12 < this.XH.childNodes.length;k12++)if(W1l == (T12=GetNode(this.XH,k12)).Kind){T12.TextColor?d12=T12.TextColor:(f12=this.getCell(T12,this.getFirstCol())) && (h12=GetStyle(f12),d12=IBSheet._ibsUtil.getWebColor(h12.color));break;}return (-A0l === d12 && (d12=this.InvalidValue),d12);},s.GetLoadColNames=function(r12,m12){var k4C="Index";for(col=this.GetFirstColA();col;col=this.GetNextColA(col))if(A0l == m12.unMatchColHidden)this.Cols[col].Visible && r12.push(col);else {if(B2l == col && B0l == this.Cols[col].Visible && k4C == this.Cols[col].Def)continue;if(R0C == col)continue;r12.push(col);}},s.GetNextColA=function(v12){if(!v12)return j4l;var x12=this.Cols;if(!x12[v12])return j4l;for(var u12=x12[v12].Section,D12=this.ColNames,K12=x12[v12].Pos + A0l;;){for(;D12[u12][K12] && e1l == D12[u12][K12];)K12++;if(D12[u12][K12])return D12[u12][K12];if((K12=B0l,++u12 >= D12.length))return j4l;}},s.GetOrgType=function(O12,B12){if(!O12 || !B12 || O12.Page)return S4l;var q12=O12[B12 + s3l];if((j4l == q12 && O12.Def && (q12=O12.Def[B12 + I1l]),j4l == q12)){var A12=O12.Space?this.DefCols.C:this.Cols[B12];(A12 && (q12=A12.LegacyType),O2l != O12.Kind || CEditTypes[q12] || e1l == q12 || R0C == B12 || (q12=Q9l));}return q12;},s.GetRHeight=function(P12,G12){if(!P12)return B0l;if(this.MultiRecord && this.MultiRecordShape && P12.r1)for(var J12=P12.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,M12=B0l;J12;){if(M12 == G12)return J12.offsetHeight;(J12=J12.nextSibling,M12++);}if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict){if(W1l != P12.Kind)return P12.Height?P12.Height:this.RowHeight;if(P12.r1 && P12.r1.offsetHeight - this.HeaderRowHeight >= this.HeaderRowHeight)return this.HeaderRowHeight;}if(P12.r1)return P12.r1.offsetHeight;var X12=P12.Height;return j4l != X12?X12:P12.Page?this.GetPageHeight(P12):(P12.Def && (X12=P12.Def.Height),j4l != X12?X12:this.RowHeight);},s.GetSheetFontName=function(){var f4C="Dotum";var b12=f4C;if(this.SheetFontName)b12=this.SheetFontName;else {var C12=this.XH.firstChild;if(C12 && C12.r1)b12=GetStyle(C12.r1).fontFamily.replace(/\"/gi,S4l).split(b4l)[B0l];}return b12;},s.GetSheetFontSize=function(){var e0l=12;var h4C="px";var p12=e0l;if(this.SheetFontSize)p12=this.SheetFontSize;else {var e12=this.XH.firstChild;if(e12 && e12.r1)p12=GetStyle(e12.r1).fontSize.replace(h4C,S4l);}return parseInt(p12,p0l);},s.GetSheetPageLength=function(){var I12=B0l;return (this.Paging && (I12=this.PageLength),I12);},s.GetStatusValue=function(Z12){var Y12=S4l,o12=this.StatusCol,z12=this.DataRows;if(!o12)return Y12;if(A0l < z12){for(var L12=this.GetUnitBaseRow(Z12);L12;L12=this.getNextRow(L12))if(z5l == this.getAttribute(L12,o12,I1l)){Y12=L12[o12];break;}}else Y12=Z12[o12] || S4l;return Y12;},s.GetSumBackColor=function(){var F12=S4l,W12=this.Rows.FormulaRow;return (F12=W12 && W12.Background?W12.Background:this.SumBackColor,IBSheet._ibsUtil.getWebColor(F12));},s.GetTheme=function(){return this.Style;},s.LoadFile=function(H32){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var j32,U32,E32,g32,a32,N32,Q32,n12=w._ibsUtil.cloneArray(H32),w32={},V32={},l32=S4l,y32=[],t32=S4l;(w.g_targetExcelSheetID=this.id,w.g_isLoadExcelBuffer || (w.g_LoadExcelSheetID=[]),w.g_LoadExcelSheetID.push(this.id),void B0l === n12 && (n12=[]),void B0l !== this.LoadExcelConfig && (w32=this.LoadExcelConfig),void B0l !== this.LoadTextConfig && (V32=this.LoadTextConfig),n12.append=this._getDefault(void B0l !== n12.append?n12.append:n12.Append,this._getDefault(w32.append,!A0l)),n12.columnMapping=this._getDefault(void B0l !== n12.columnMapping?n12.columnMapping:n12.ColumnMapping,this._getDefault(w32.columnMapping,S4l)),n12.debugMode=this._getDefault(void B0l !== n12.debugMode?n12.debugMode:n12.DebugMode,this._getDefault(w32.debugMode,!A0l)),n12.endRow=this._getDefault(void B0l !== n12.endRow?n12.endRow:n12.EndRow,this._getDefault(w32.endRow,B0l)),n12.extendParam=this._getDefault(void B0l !== n12.extendParam?n12.extendParam:n12.ExtendParam,this._getDefault(w32.extendParam,S4l)),n12.fileExt=this._getDefault(void B0l !== n12.fileExt?n12.fileExt:n12.FileExt,this._getDefault(w32.fileExt,S4l)),n12.maxFileSize=this._getDefault(void B0l !== n12.maxFileSize?n12.maxFileSize:n12.MaxFileSize,this._getDefault(w32.maxFileSize,B0l,V5l),V5l),n12.merge=this._getDefault(void B0l !== n12.merge?n12.merge:n12.Merge,this._getDefault(w32.merge,A0l)),n12.mode=this._getDefault(void B0l !== n12.mode?n12.mode:n12.Mode,this._getDefault(w32.mode,Q5l)),n12.serverFile=this._getDefault(void B0l !== n12.serverFile?n12.serverFile:n12.ServerFile,this._getDefault(w32.serverFile,S4l)),n12.startCol=this._getDefault(void B0l !== n12.startCol?n12.startCol:n12.StartCol,this._getDefault(w32.startCol,A0l)),n12.startRow=this._getDefault(void B0l !== n12.startRow?n12.startRow:n12.StartRow,this._getDefault(w32.startRow,A0l)),n12.unMatchColHidden=this._getDefault(void B0l !== n12.unMatchColHidden?n12.unMatchColHidden:n12.UnMatchColHidden,this._getDefault(w32.unMatchColHidden,S4l)),n12.useDOM=this._getDefault(void B0l !== n12.useDOM?n12.useDOM:n12.UseDOM,this._getDefault(w32.useDOM,!A0l)),n12.workSheetName=this._getDefault(void B0l !== n12.workSheetName?n12.workSheetName:n12.WorkSheetName,this._getDefault(w32.workSheetName,S4l)),n12.workSheetNo=this._getDefault(void B0l !== n12.workSheetNo?n12.workSheetNo:n12.WorkSheetNo,this._getDefault(w32.workSheetNo,A0l)),n12.encoding=this._getDefault(void B0l !== n12.encoding?n12.encoding:n12.Encoding,this._getDefault(V32.encoding,S4l)),n12.deli=this._getDefault(void B0l !== n12.deli?n12.deli:n12.Deli,this._getDefault(V32.deli,r4C)),n12.colSeparator=this._getDefault(void B0l !== n12.colSeparator?n12.colSeparator:n12.ColSeparator,this._getDefault(V32.colSeparator,r4C)),r4C !== n12.colSeparator && n12.colSeparator !== n12.deli && (n12.deli=n12.colSeparator),n12.skipEmptyRow=this._getDefault(void B0l !== n12.skipEmptyRow?n12.skipEmptyRow:n12.SkipEmptyRow,this._getDefault(w32.skipEmptyRow,!B0l)),n12.colLength=this._getDefault(void B0l !== n12.colLength?n12.colLength:n12.ColLength,this._getDefault(V32.colLength,S4l)),n12.colLength2Byte=this._getDefault(void B0l !== n12.colLength2Byte?n12.colLength2Byte:n12.ColLength2Byte,this._getDefault(V32.colLength2Byte,!B0l)),n12.emptyChar=this._getDefault(void B0l !== n12.emptyChar?n12.emptyChar:n12.EmptyChar,this._getDefault(V32.emptyChar,F8l)),n12.fillRight=this._getDefault(void B0l !== n12.fillRight?n12.fillRight:n12.FillRight,this._getDefault(V32.fillRight,!B0l)));var s32=n12.colLength;if((S4l != s32 && l5l != s32 && (n8l == s32.substring(B0l,A0l) && (s32=s32.substring(A0l)),n8l == s32.substring(s32.length - A0l) && (s32=s32.substring(B0l,s32.length - A0l)),n12.colLength=s32),void B0l !== n12.DialogType && (n12.dialogType=n12.DialogType),void B0l !== n12.Action && (n12.action=n12.Action),void B0l !== n12.LoadAction && (n12.loadAction=n12.LoadAction),void B0l !== n12.DialogTheme && (n12.dialogTheme=n12.DialogTheme),void B0l !== n12.DialogSheetTheme && (n12.dialogSheetTheme=n12.DialogSheetTheme),void B0l !== n12.DisableSheet && (n12.disableSheet=n12.DisableSheet),void B0l !== n12.CallBack && (n12.callBack=n12.CallBack),this._uploadDialogDelim=n12.deli,this._uploadDialogLoadType=n12.dialogType,n12.action && V8l == typeof n12.action?this._uploadDialogAction=n12.action:this._uploadDialogAction=j4l,n12.loadAction && V8l == typeof n12.loadAction?this._uploadDialogLoadFile=n12.loadAction:this._uploadDialogLoadFile=j4l,n12.dialogTheme?this._uploadDialogTheme=n12.dialogTheme:this._uploadDialogTheme=j4l,n12.dialogSheetTheme?this._uploadDialogSheetTheme=n12.dialogSheetTheme:this._uploadDialogSheetTheme=j4l,n12.disableSheet?this._uploadDisableSheet=A0l:this._uploadDisableSheet=j4l,n12.callBack && V8l == typeof n12.callBack?this._uploadCallBack=n12.callBack:this._uploadCallBack=j4l,this._autoExcelModeCheck(n12,this.AutoExcelMode,c1l,!A0l,!A0l))){if((this.GetLoadColNames(y32,n12),N32=this._getHeaderText(y32),j32=(Q32=this._getColInfo(n12,y32,!A0l)).name,U32=Q32.saveName,E32=Q32.type,g32=Q32.format,a32=Q32.datePattern,l32+=this._makeColumnTag(y5l,n12.append?A0l:B0l),l32+=this._makeColumnTag(t5l,n12.unMatchColHidden),l32+=this._makeColumnTag(j5l,this.SearchMode),l32+=this._makeColumnTag(U5l,n12.extendParam),l32+=this._makeColumnTag(E5l,y32.length),l32+=this._makeColumnTag(a5l,this.getHeaderRows().length),l32+=this._makeColumnTag(N5l,n12.startRow),l32+=this._makeColumnTag(H5l,n12.endRow),l32+=this._makeColumnTag(S5l,n12.startCol),l32+=this._makeColumnTag(i5l,n12.workSheetNo),l32+=this._makeColumnTag(R5l,n12.workSheetName),l32+=this._makeColumnTag(c5l,n12.mode.replace(/ /g,S4l).toUpperCase()),l32+=this._makeColumnTag(d5l,void B0l !== this.StatusCol?this.StatusCol:S4l),l32+=this._makeColumnTag(T5l,n12.columnMapping),l32+=this._makeColumnTag(k5l,j32),l32+=this._makeColumnTag(f5l,U32),l32+=this._makeColumnTag(h5l,N32),l32+=this._makeColumnTag(r5l,j32),l32+=this._makeColumnTag(m5l,E32),l32+=this._makeColumnTag(K5l,g32),l32+=this._makeColumnTag(u5l,a32),l32+=this._makeColumnTag(D5l,this.id),l32+=this._makeColumnTag(m4C,n12.deli),l32+=this._makeColumnTag(K4C,n12.encoding),l32+=this._makeColumnTag(v5l,n12.merge),l32+=this._makeColumnTag(x5l,this.UseJsonAttribute),l32+=this._makeColumnTag(q5l,n12.serverFile),t32=this._getDefault(this.Source.LoadExcel.Url,A5l),t32=w._ibsUtil.getFullPath(t32),l32+=this._makeColumnTag(P5l,t32),V8l != typeof Q.postMessage && I4l != typeof Q.postMessage || (l32+=this._makeColumnTag(X5l,this.id)),l32+=this._makeColumnTag(J5l,n12.useDOM?A0l:B0l),l32+=this._makeColumnTag(u4C,n12.colLength),l32+=this._makeColumnTag(D4C,n12.colLength2Byte?A0l:B0l),l32+=this._makeColumnTag(v4C,n12.emptyChar),l32+=this._makeColumnTag(x4C,n12.fillRight?A0l:B0l),l32+=this._makeColumnTag(q4C,n12.cutText?A0l:B0l),l32+=this._makeColumnTag(O5l,n12.skipEmptyRow?A0l:B0l),n12.debugMode || n12.DebugMode))return l32;this._makeLoadForm(c1l,!A0l,n12.fileExt,l32,n12.maxFileSize,n12.serverFile);}},s.mUnMatchColHidden=function(R32){var S32,i32=R32.split(n8l);for(S32=A0l;S32 < i32.length;S32++)B0l == this.GetColHidden(i32[S32]) && this.SetColHidden(i32[S32],!B0l);},s.ShowAlert=function(c32,d32,k32,f32){var O4C="Ok";var T32=this;return this.MessageShowLevel && W0C !== this.MessageShowLevel || W0C === d32?(this.AlertProgress=A0l,W0C != d32 && IBSheet.OnDebugMsg && IBSheet.OnDebugMsg(this,c32,d32),this.ShowMsgMode?k32?confirm(c32)?(this.AlertProgress=B0l,!(this._invalidInputActionProc=B0l)):(this.AlertProgress=B0l,this._invalidInputActionProc=B0l,!A0l):void setTimeout(function(){(alert(c32),V8l == typeof f32 && f32(T32),T32.AlertProgress=B0l);},M0l):(IBSheet.OnMessage?IBSheet.OnMessage(this,c32,d32,k32):this.showMessageTime(c32,B0l,j4l,[O4C]),this.ConfirmInfo?(this.ConfirmInfo=B0l,this.AlertProgress=B0l,!(this._invalidInputActionProc=B0l)):(this.AlertProgress=B0l,this._invalidInputActionProc=B0l,!A0l))):-A0l;},s.Down2Text=function(O32){var A4C="Down2Text.jsp";var B4C="EUC-KR";var h32,r32,v32,K32,x32,q32,m32,u32=this;(void B0l === (h32=w._ibsUtil.cloneArray(O32)) && (h32=[]),this._prepareExportSetting(),h32 && !h32.DebugMode && this.showMessage(this.getMessage(J8l),(this.SuppressMessage || B0l) + A0l,A0l),void B0l === (r32=this.Down2TextConfig) && (r32={}),h32.checkBoxOffValue=this._getDefault(void B0l !== h32.checkBoxOffValue?h32.checkBoxOffValue:h32.CheckBoxOffValue,this._getDefault(r32.checkBoxOffValue,M4l)),h32.checkBoxOnValue=this._getDefault(void B0l !== h32.checkBoxOnValue?h32.checkBoxOnValue:h32.CheckBoxOnValue,this._getDefault(r32.checkBoxOnValue,M8l)),h32.debugMode=this._getDefault(void B0l !== h32.debugMode?h32.debugMode:h32.DebugMode,this._getDefault(r32.debugMode,!A0l)),h32.downCols=this._getDefault(void B0l !== h32.downCols?h32.downCols:h32.DownCols,this._getDefault(r32.downCols,S4l)),h32.downCombo=this._getDefault(void B0l !== h32.downCombo?h32.downCombo:h32.DownCombo,this._getDefault(r32.downCombo,Q9l)).toUpperCase(),h32.downHeader=this._getDefault(void B0l !== h32.downHeader?h32.downHeader:h32.DownHeader,this._getDefault(r32.downHeader,!B0l)),h32.downRows=this._getDefault(void B0l !== h32.downRows?h32.downRows:h32.DownRows,this._getDefault(r32.downRows,S4l)),h32.downSum=this._getDefault(void B0l !== h32.downSum?h32.downSum:h32.DownSum,this._getDefault(r32.downSum,!B0l)),h32.downTreeHide=this._getDefault(void B0l !== h32.downTreeHide?h32.downTreeHide:h32.DownTreeHide,this._getDefault(r32.downTreeHide,! !this.ExcelTreeMode)),h32.excludeSubSum=this._getDefault(void B0l !== h32.excludeSubSum?h32.excludeSubSum:h32.ExcludeSubSum,this._getDefault(r32.excludeSubSum,B0l)),h32.extendParam=this._getDefault(void B0l !== h32.extendParam?h32.extendParam:h32.ExtendParam,this._getDefault(r32.extendParam,S4l)),h32.extendParamMethod=this._getDefault(void B0l !== h32.extendParamMethod?h32.extendParamMethod:h32.ExtendParamMethod,this._getDefault(r32.extendParamMethod,S4l)),h32.fileName=this._getDefault(void B0l !== h32.fileName?h32.fileName:h32.FileName,this._getDefault(r32.fileName,Q9l)),h32.RequiredMark=this._getDefault((h32.RequiredMark,h32.RequiredMark),this._getDefault(r32.RequiredMark,!B0l)),h32.multipart=this._getDefault(void B0l !== h32.multipart?h32.multipart:h32.Multipart,this._getDefault(r32.multipart,!B0l)),h32.rowDelim=this._getDefault(void B0l !== h32.rowDelim?h32.rowDelim:h32.RowDelim,this._getDefault(r32.rowDelim,a8l)),h32.sheetName=this._getDefault(void B0l !== h32.sheetName?h32.sheetName:h32.SheetName,this._getDefault(r32.sheetName,C8l)),h32.colLength=this._getDefault(void B0l !== h32.colLength?h32.colLength:h32.ColLength,this._getDefault(r32.colLength,S4l)),h32.colLength2Byte=this._getDefault(void B0l !== h32.colLength2Byte?h32.colLength2Byte:h32.ColLength2Byte,this._getDefault(r32.colLength2Byte,!B0l)),h32.emptyChar=this._getDefault(void B0l !== h32.emptyChar?h32.emptyChar:h32.EmptyChar,this._getDefault(r32.emptyChar,F8l)),h32.fillRight=this._getDefault(void B0l !== h32.fillRight?h32.fillRight:h32.FillRight,this._getDefault(r32.fillRight,!B0l)),h32.cutText=this._getDefault(void B0l !== h32.cutText?h32.cutText:h32.CutText,this._getDefault(r32.cutText,!A0l)),h32.timeout=this._getDefault(void B0l !== h32.timeout?h32.timeout:h32.Timeout,this._getDefault(r32.timeout,B0l)));var D32=h32.fileName.toLowerCase().split(v8l,-A0l);if((c4C == D32[D32.length - A0l]?(h32.colDelim=this._getDefault(void B0l !== h32.colDelim?h32.colDelim:h32.ColDelim,this._getDefault(r32.colDelim,b4l)),h32.downloadEncoding=this._getDefault(void B0l !== h32.downloadEncoding?h32.downloadEncoding:h32.DownloadEncoding,this._getDefault(r32.downloadEncoding,B4C))):(h32.colDelim=this._getDefault(void B0l !== h32.colDelim?h32.colDelim:h32.ColDelim,this._getDefault(r32.colDelim,r4C)),h32.downloadEncoding=this._getDefault(void B0l !== h32.downloadEncoding?h32.downloadEncoding:h32.DownloadEncoding,this._getDefault(r32.downloadEncoding,S4l))),this._autoExcelModeCheck(h32,this.AutoExcelMode,G8l,!B0l,!A0l)))return (S4l != h32.downRows && h32.downTreeHide && (h32.downTreeHide=B0l),h32.downRows=n8l + h32.downRows + n8l,l5l != (K32=h32.downCols) && (n8l == K32.substring(B0l,A0l) && (K32=K32.substring(A0l)),n8l == K32.substring(K32.length - A0l) && (K32=K32.substring(B0l,K32.length - A0l)),h32.downCols=K32),S4l != (m32=h32.colLength) && l5l != m32 && (n8l == m32.substring(B0l,A0l) && (m32=m32.substring(A0l)),n8l == m32.substring(m32.length - A0l) && (m32=m32.substring(B0l,m32.length - A0l)),h32.colLength=m32),void B0l === this.Source.Down2Text.Url?this.Source.Down2Text.Url=A4C:S4l == this.Source.Down2Text.Url && (this.Source.Down2Text.Url=A4C),v32=this.Source.Down2Text.Url,x32=h32.extendParam,q32=h32.extendParamMethod,this._getDown2Text(h32,function(B32){u32._sendDown(B32,v32,x32,q32,h32.multipart,G8l,h32.debugMode,h32.timeout);}));setTimeout(function(){u32.hideMessage();},p0l);},s.GetDown2TextConfig=function(){return this.Down2TextConfig;},s.GetDown2TextUrl=function(){var A32=S4l;return (this.Source.Down2Text.Url && (A32=this.Source.Down2Text.Url),A32);},s.GetLoadTextConfig=function(){return this.LoadTextConfig || ({});},s.GetLoadTextUrl=function(){var P32=S4l;return (this.Source.LoadText.Url && (P32=this.Source.LoadText.Url),P32);},s.LoadText=function(o32){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this.LoadFileType=G8l);var p32,e32,I32,L32,Y32,b32,X32=w._ibsUtil.cloneArray(o32),M32={},J32=S4l,C32=[];(void B0l === X32 && (X32=[]),void B0l !== this.LoadTextConfig && (M32=this.LoadTextConfig),this._prepareExportSetting(),X32.append=this._getDefault(void B0l !== X32.append?X32.append:X32.Append,this._getDefault(M32.append,!A0l)),X32.fileExt=this._getDefault(void B0l !== X32.fileExt?X32.fileExt:X32.FileExt,this._getDefault(M32.fileExt,S4l)),X32.maxFileSize=this._getDefault(void B0l !== X32.maxFileSize?X32.maxFileSize:X32.MaxFileSize,this._getDefault(M32.maxFileSize,B0l,V5l)),X32.mode=this._getDefault(void B0l !== X32.mode?X32.mode:X32.Mode,this._getDefault(M32.mode,Q5l)),X32.encoding=this._getDefault(void B0l !== X32.encoding?X32.encoding:X32.Encoding,this._getDefault(M32.encoding,S4l)),X32.deli=this._getDefault(void B0l !== X32.deli?X32.deli:X32.Deli,this._getDefault(M32.deli,r4C)),X32.colSeparator=this._getDefault(void B0l !== X32.colSeparator?X32.colSeparator:X32.ColSeparator,this._getDefault(M32.colSeparator,r4C)),r4C !== X32.colSeparator && X32.colSeparator !== X32.deli && (X32.deli=X32.colSeparator),X32.colLength=this._getDefault(void B0l !== X32.colLength?X32.colLength:X32.ColLength,this._getDefault(M32.colLength,S4l)),X32.colLength2Byte=this._getDefault(void B0l !== X32.colLength2Byte?X32.colLength2Byte:X32.ColLength2Byte,this._getDefault(M32.colLength2Byte,!B0l)),X32.emptyChar=this._getDefault(void B0l !== X32.emptyChar?X32.emptyChar:X32.EmptyChar,this._getDefault(M32.emptyChar,F8l)),X32.fillRight=this._getDefault(void B0l !== X32.fillRight?X32.fillRight:X32.FillRight,this._getDefault(M32.fillRight,!B0l)),X32.hideSeq=y8l == typeof X32.hideSeq && B0l <= X32.hideSeq && X32.hideSeq <= P0l?X32.hideSeq:P0l);var G32=X32.colLength;(S4l != G32 && l5l != G32 && (n8l == G32.substring(B0l,A0l) && (G32=G32.substring(A0l)),n8l == G32.substring(G32.length - A0l) && (G32=G32.substring(B0l,G32.length - A0l)),X32.colLength=G32),void B0l !== X32.DialogType && (X32.dialogType=X32.DialogType),this._uploadDialogDelim=X32.deli,this._uploadDialogLoadType=X32.dialogType,this._autoExcelModeCheck(X32,this.AutoExcelMode,G8l,!A0l,!A0l) && (this.GetLoadColNames(C32,X32),Y32=this._getHeaderText(C32),p32=(b32=this._getColInfo(X32,C32,!A0l)).name,b32.saveName,e32=b32.type,I32=b32.format,L32=b32.datePattern,dataFormat=b32.dataFormat,J32+=this._makeColumnTag(c5l,X32.mode.replace(/ /g,S4l).toUpperCase()),J32+=this._makeColumnTag(m4C,X32.deli),J32+=this._makeColumnTag(y5l,X32.append?A0l:B0l),J32+=this._makeColumnTag(j5l,this.SearchMode),J32+=this._makeColumnTag(U5l,X32.extendParam),J32+=this._makeColumnTag(E5l,this.ColCount),J32+=this._makeColumnTag(g5l,dataFormat),J32+=this._makeColumnTag(a5l,this.getHeaderRows().length),J32+=this._makeColumnTag(d5l,void B0l !== this.StatusCol?this.StatusCol:S4l),J32+=this._makeColumnTag(k5l,p32),J32+=this._makeColumnTag(h5l,Y32),J32+=this._makeColumnTag(r5l,p32),J32+=this._makeColumnTag(m5l,e32),J32+=this._makeColumnTag(K5l,I32),J32+=this._makeColumnTag(u5l,L32),J32+=this._makeColumnTag(K4C,X32.encoding),J32+=this._makeColumnTag(u4C,X32.colLength),J32+=this._makeColumnTag(D4C,X32.colLength2Byte?A0l:B0l),J32+=this._makeColumnTag(v4C,X32.emptyChar),J32+=this._makeColumnTag(x4C,X32.fillRight?A0l:B0l),V8l != typeof Q.postMessage && I4l != typeof Q.postMessage || (J32+=this._makeColumnTag(X5l,this.id)),this._makeLoadForm(G8l,!A0l,X32.fileExt,J32,X32.maxFileSize)));},s.SetDown2TextConfig=function(Z32){(this.Down2TextConfig=w._ibsUtil.cloneArray(Z32),void B0l !== this.Down2TextConfig.downHeader && (M8l === this.Down2TextConfig.downHeader?this.Down2TextConfig.downHeader=!B0l:M4l === this.Down2TextConfig.downHeader && (this.Down2TextConfig.downHeader=!A0l)),void B0l !== this.Down2TextConfig.downSum && (M8l === this.Down2TextConfig.downSum?this.Down2TextConfig.downSum=!B0l:M4l === this.Down2TextConfig.downSum && (this.Down2TextConfig.downSum=!A0l)),void B0l !== this.Down2TextConfig.RequiredMark && (M8l === this.Down2TextConfig.RequiredMark?this.Down2TextConfig.RequiredMark=!B0l:M4l === this.Down2TextConfig.RequiredMark && (this.Down2TextConfig.RequiredMark=!A0l)),void B0l !== this.Down2TextConfig.multipart && (M8l === this.Down2TextConfig.multipart?this.Down2TextConfig.multipart=!B0l:M4l === this.Down2TextConfig.multipart && (this.Down2TextConfig.multipart=!A0l)));},s.SetDown2TextUrl=function(z32){(this.Source.Down2Text || (this.Source.Down2Text={}),this.Source.Down2Text.Url=z32);},s.SetLoadTextConfig=function(W32){(this.LoadTextConfig=w._ibsUtil.cloneArray(W32),void B0l !== this.LoadTextConfig.append && (M8l === this.LoadTextConfig.append?this.LoadTextConfig.append=!B0l:M4l === this.LoadTextConfig.append && (this.LoadTextConfig.append=!A0l)));},s.SetLoadTextUrl=function(F32){(this.Source.LoadText || (this.Source.LoadText={}),this.Source.LoadText.Url=F32);},s._exportCsv=function(U0l,E0l,g0l,a0l,N0l,y0l,H0l){var Q0l=[],n32=j4l,s0l=B0l,t0l=B0l,l0l={},V0l=[],w0l=S4l,j0l=A0l < this.DataRows;for(n32=this.getFirstRow(j4l,C0l);n32;n32=this.getNextRow(n32))if(!n32 || C5l !== n32.id && L7l !== n32.Name && Y7l !== n32.Name){for((s0l=B0l,t0l=U0l.length);s0l < t0l;s0l++)if((l0l=U0l[s0l],!j0l || n32.UnitPos == l0l.UnitPos)){if((w0l=A0l == N0l && void B0l === l0l.Name?S4l:E0l?this._getCellText(n32,l0l.Name):this._getCellValue(n32,l0l.Name),l0l.Name === H0l && A0l != w0l))break;(void B0l !== y0l && (w0l=w0l.replace(/\r\n/g,y0l).replace(/\n/g,y0l)),V0l.push(w0l));}j0l && n32.UnitPos != this.DataRows - A0l || B0l < V0l.length && (Q0l.push(V0l.join(g0l)),V0l=[]);}return Q0l=Q0l.join(a0l);},s._getDown2Text=function(i0l,m0l){var M4C="DownloadEncoding";var J4C="ColDelim";var X4C="RowDelim";var P4C="txt";var d0l,K0l,T0l,u0l,D0l,v0l,x0l,k0l,h0l,R0l=[],r0l=A0l,c0l=this,S0l=S4l,q0l=l5l != i0l.downRows,f0l=[];return B0l == (K0l=(f0l=this.MultiRecord && this.MultiRecordShape?this._DownMultiMap[B0l]:this._getDownColNames(i0l)).length)?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,G8l,!A0l),-A0l):(k0l={from:G8l,cfg:i0l,sheetDesign:!A0l,isTreeLevel:B0l,isDownRows:q0l,isDownRowVisible:B0l,rowHeights:[],downColNames:f0l,downColNamesLength:K0l,data:R0l,p:r0l,headerRows:B0l,isHeaderMerge:B0l},i0l.downHeader && (h0l=this._getHeaderData(k0l),k0l.p=h0l.p),A0l != w.g_isDirectDown2Excel && (r0l=(h0l=this._getBodyData(k0l)).p),this.fileDownloadCheckToken=new Date().getTime(),w.fileDownloadCheckTimer=Q.setInterval(function(){c0l._getCookie(s5l) == c0l.fileDownloadCheckToken && (c0l.fileDownloadCheckToken=j4l,c0l._finishDownload(G8l));},F0l),S0l+=this._makeColumnTag(a7l,this.fileDownloadCheckToken),x0l=(T0l=this._getColInfo(i0l,f0l,B0l)).saveName,u0l=T0l.type,v0l=T0l.format,D0l=T0l.orgFormat,(d0l=location.href.substring(location.href.indexOf(o4l) + P0l).split(N7l))[B0l]=S4l,d0l[d0l.length - A0l]=S4l,S0l+=this._makeColumnTag(T7l,d0l.join(N7l)),S0l+=this._makeColumnTag(k7l,w._ibsUtil.getFileName(i0l.fileName,P4C)),S0l+=this._makeColumnTag(X4C,i0l.rowDelim),S0l+=this._makeColumnTag(J4C,i0l.colDelim),S0l+=this._makeColumnTag(U5l,i0l.extendParam),S0l+=this._makeColumnTag(k5l,x0l),S0l+=this._makeColumnTag(B7l,u0l),S0l+=this._makeColumnTag(A7l,v0l),S0l+=this._makeColumnTag(P7l,D0l),S0l+=this._makeColumnTag(C7l,i0l.downHeader?A0l:B0l),S0l+=this._makeColumnTag(u4C,i0l.colLength),S0l+=this._makeColumnTag(D4C,i0l.colLength2Byte?A0l:B0l),S0l+=this._makeColumnTag(v4C,i0l.emptyChar),S0l+=this._makeColumnTag(x4C,i0l.fillRight?A0l:B0l),S0l+=this._makeColumnTag(q4C,i0l.cutText?A0l:B0l),S0l+=this._makeColumnTag(M4C,i0l.downloadEncoding),S0l+=this.IB_DELIMITER_ROW,R0l[B0l]=S0l,i0l.debugMode?R0l.join(S4l):void (m0l && m0l(R0l.join(S4l))));},K=s,(B0l,w.__.each)([{from:G4C,to:b4C},{from:C4C,to:p4C},{from:e4C,to:I4C},{from:L4C,to:Y4C},{from:o4C,to:Z4C},{from:z4C,to:W4C},{from:F4C,to:n4C},{from:l8C,to:w8C},{from:s8C,to:V8C},{from:Q8C,to:y8C},{from:t8C,to:j8C},{from:U8C,to:E8C},{from:g8C,to:a8C},{from:N8C,to:H8C},{from:S8C,to:i8C},{from:R8C,to:c8C},{from:d8C,to:T8C},{from:t9l,to:k8C},{from:j9l,to:f8C},{from:v0C,to:h8C},{from:r8C,to:m8C},{from:x0C,to:K8C},{from:U9l,to:u8C},{from:A0C,to:D8C},{from:v8C,to:x8C},{from:g9l,to:q8C},{from:V4C,to:O8C},{from:B8C,to:A8C},{from:P8C,to:X8C},{from:J8C,to:M8C},{from:G8C,to:b8C},{from:C8C,to:p8C},{from:e8C,to:I8C},{from:L8C,to:Y8C},{from:o8C,to:Z8C},{from:z8C,to:W8C},{from:F8C,to:n8C},{from:l5C,to:w5C},{from:s5C,to:V5C},{from:Q5C,to:y5C},{from:t5C,to:j5C},{from:U5C,to:E5C},{from:g5C,to:a5C},{from:M5l,to:N5C},{from:H5C,to:S5C},{from:i5C,to:R5C},{from:c5C,to:d5C},{from:T5C,to:k5C}],function(O0l){K[O0l.to]=K[O0l.from];}));function q(M){var K5C='"Code":';var P5C="IBSheetLoadFileSelect";var h5C=/(Result( )?:)/;var m5C=/(Code( )?:)/;var q5C="\\\\t";var v5C=/(data( )?:( )?\[\[)/;var D5C='"Message":';var O5C="IBSheetOnLoadFullExcel";var A5C="UploadFile";var r5C='"Result":';var f5C="IBSheetOnLoadExcel";var x5C='"data":[[';var X5C="IBSheetLoadFileExtError";var u5C=/(Message( )?:)/;var B5C="IBSheetLoadExcelShowProcessDlg";try{var X,J,P=M.data.split(j4C),O=P[B0l].split(e4l),B={};if(Q[O[A0l]].HasLoadedExcelData)return !A0l;if(M0l == O.length && f5C == O[B0l]){var A=JSON.parse(P[A0l].replace(h5C,r5C).replace(m5C,K5C).replace(u5C,D5C).replace(v5C,x5C).replace(/	/g,q5C)).data;return (A.length && A0l === A.length && A[B0l].length && (A=A[B0l]),J=P0l == (X=O[J0l].split(g7l)).length?IBSheet[O[A0l]]._getBooleanValue(X[A0l],B0l):S4l,B.append=J,Q[O[A0l]].CheckLoadExcel=O[X0l],void Q[O[A0l]].loadSearchData({data:A,append:B.append}));}if(M0l == O.length && O5C == O[B0l]){J=P0l == (X=O[J0l].split(g7l)).length?IBSheet[O[A0l]]._getBooleanValue(X[A0l],B0l):S4l;P[A0l];(B.type=O[X0l],B.append=J,B.dialogType=IBSheet[O[A0l]]._uploadDialogLoadType,IBSheet[O[A0l]].hideMessage(),IBSheet[O[A0l]].uploadDialogLoad && IBSheet[O[A0l]].uploadDialogLoad(P[A0l],B));}(A0l == O.length && (B0C == O[B0l] || M0C == O[B0l]?V.getElementById(O[B0l]).click():B5C == O[B0l] && this.showMessage(this.getMessage(A5C))),X0l == O.length && (P5C == O[B0l]?IBSheet.OnLoadFileSelect && IBSheet.OnLoadFileSelect(IBSheet[O[P0l]],O[A0l],P[A0l]):X5C == O[B0l] && (e8l == O[A0l]?IBSheet[O[P0l]].ShowAlert(IBSheet[O[P0l]].getMessage(a4C,G5l),W0C):G8l == O[A0l] && IBSheet[O[P0l]].ShowAlert(IBSheet[O[P0l]].getMessage(N4C,G5l),W0C))));}catch(G){}}})(window,document);